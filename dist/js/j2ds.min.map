{"version":3,"sources":["MathUtil.js","TextureUtil.js","Dom.js","Gui.js","Events.js","BaseNode.js","CircleNode.js","LineNode.js","RectNode.js","SpriteNode.js","TextNode.js","DeviceManager.js","ErrorManager.js","FpsManager.js","ResourceManager.js","StorageManager.js","TimeManager.js","TriggerManager.js","ViewManager.js","AudioHandler.js","InputHandler.js","Layers.js","Scene.js","j2Ds.js"],"names":["root","factory","define","amd","module","exports","window","global","MathUtil","v2f","x","y","v2i","toInt","number","rndColor","min","max","opacity","random","omitZero","Math","floor","rad","num","PI","is4VerticesIntersect","a","b","m","n","length","isLineIntersect","c","d","dx","g","l","isPointInRect","p","isPointInTriangle","sign","p1","p2","p3","pt","b1","b2","b3","undefined","j2Ds","modules","utils","TextureUtil","this","prototype","createImageMap","width","height","callback","textureUtil","resources","add","image","img","loaded","document","createElement","context","getContext","getAnimation","sourceX","sourceY","sourceW","sourceH","frameCount","imageMap","ok","loadImageMap","path","crossOrigin","src","addEventListener","templates","ellipse","size","color","fillRect","fillStyle","strokeRect","lineWidth","strokeStyle","gradientL","colors","isHorizontal","gradient","createLinearGradient","step","i","j","addColorStop","gradientR","pos1","r1","pos2","r2","createRadialGradient","Dom","id","getElementById","name","getElementsByName","tag","parent","getElementsByTagName","goURL","url","location","href","reloadURL","attach","dom","events","addEvent","appendChild","injectJavaScript","code","toString","replace","callJava","send","ajax","XMLHttpRequest","open","onreadystatechange","readyState","status","responseText","core","Gui","nodes","Events","scene:deactivate","scene:activate","scene:beforeInit","scene:afterInit","scene:beforeStart","scene:afterStart","engine:before","engine:after","scene:changedGameState","writeMode:keyPress","dom:loaded","eventType","push","now","ready","onEvent","destroyEvent","len","splice","args","err","errorManager","showError","require","BaseNode","j2DsEngine","pos","visible","alpha","angle","layer","scene","box","offset","resizeBox","setLayer","layers","getLayer","setVisible","isVisible","setAlpha","getAlpha","moveTo","to","t","move","getPosition","setPosition","ceil","setSize","getSize","setParent","getDistance","sqrt","pow","getDistanceXY","abs","getBox","node","x1","x2","y1","y2","getBoxVertices","view","dy","sin","cos","toFixed","checkBoxIntersect","node1","node2","isPointInsideBox","vf","point","isIntersect","Array","isCollision","result","isLookScene","turn","setRotation","getRotation","rotateTo","atan2","isOutScene","vector","all","moveDir","speed","drawBox","save","translate","rotate","beginPath","rect","stroke","restore","CircleNode","radius","call","Object","create","constructor","draw","tmpAlpha","globalAlpha","arc","fill","LineNode","points","scale","cFill","lineTo","RectNode","SpriteNode","animation","tmpSpeed","frame","flip","setFlip","drawFrame","show","drawImage","setAnimation","TextNode","text","sizePx","family","colorL","vAlign","hAlign","font","fullText","maxWidth","lines","split","measureText","drawSimpleText","textAlign","textBaseline","strokeText","fillText","getText","setText","DeviceManager","parseInt","documentElement","clientWidth","screen","clientHeight","managers","ErrorManager","mode","enabled","init","_true","runBtn","innerHTML","style","padding","align","position","zIndex","left","top","getDeviceManager","fontSize","backgroundColor","cursor","onmousedown","e","stopPropagation","onclick","runEngine","logListener","elems","pauseBtn","stopEngine","reloadBtn","onerror","string","console","log","setMode","debug","_func","stack","match","file","line","decodeURI","errMess","message","domId","count","execLine","lightSyntax","_code","_type","FpsManager","fps","frameLimit","tmp_of_fps","tmp_of_time","Date","fpsManager","update","getFPS","ResourceManager","added","failed","fail","isLoaded","getProgress","StorageManager","ls","localStorage","alert","saveNode","o","setItem","JSON","stringify","load","getItem","is","value","loadNode","parse","TimeManager","times","insert","get","TriggerManager","triggers","triggerManager","trigger","command","state","last","run","mSec","job","loop","reset","ViewManager","views","viewManager","viewport","focusNode","AudioHandler","audios","audioHandler","deactivate","activate","files","vol","audio","source","volume","sound","domEl","lock","onePlay","explicitOriginalTarget","currentSrc","setLock","play","unlock","currentTime","pause","stop","setVolume","getVolume","getState","getPlayPosition","snd","io","InputHandler","screenPos","touch","touchTap","touchHold","touchAutoHold","touchCount","touchDuration","keyDown","keyPress","keyPressed","keyUp","keyUped","mouseDown","mousePress","mousePressed","mouseUp","mouseUpped","mouseWheel","canceled","body","anyKey","anyMouse","writeMode","displayCursor","mKey","LEFT","MIDDLE","RIGHT","jKey","UP","DOWN","SPACE","CTRL","SHIFT","ALT","ESC","ENTER","MINUS","PLUS","CAPS_LOCK","BACKSPACE","TAB","Q","W","E","R","T","Y","U","I","O","P","A","S","D","F","G","H","J","K","L","Z","X","V","B","N","M","0","1","2","3","4","5","6","7","8","C","9","NUM_0","NUM_1","NUM_2","NUM_3","NUM_4","NUM_5","NUM_6","NUM_7","NUM_8","NUM_9","NUM_MINUS","NUM_PLUS","NUM_LOCK","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","keyList","isKeyDown","isKeyPress","isKeyUp","getScreenPosition","setWriteMode","isWriteMode","keyEvent","type","keyCode","preventDefault","char","which","charCode","String","fromCharCode","cancel","onNode","upd","dX","offsetWidth","dY","offsetHeight","onMove","input","offsetLeft","pageX","offsetTop","pageY","isMouseDown","isMousePress","isMouseUp","isTouch","isTouchTap","isTouchHold","setTouchDuration","duration","isMouseWheel","onMouseWheel","wheelDelta","detail","onMouseEvent","button","mouseUped","focus","onTouchEvent","touches","setCursorImage","curImg","oncontextmenu","onselectstart","ondragstart","onmouseup","onmousemove","onkeydown","onkeyup","onkeypress","onmousewheel","Layers","layersList","index","notDOM","layerName","canvas","stylePosition","shadowColor","onContext","display","setIndex","clear","clearRect","clearNode","setContextSettings","settings","Scene","gameStateName","canFullScreen","texture","setView","getView","setAutoDraw","toggle","drawAllNodes","setAutoClear","setGameState","gameStates","states","start","setActiveEngine","getGameState","fullScreen","tmpCanvas","tmpContext","origWidth","origHeight","fullScale","canDeactivate","cancelClear","onload","onblur","stopAll","onfocus","initCanvas","addBaseNode","addCircleNode","addLineNode","addRectNode","addSpriteNode","addTextNode","DOM","GUI","FPSManager","dt","sceneStartTime","sceneSkipTime","engine","gui","timeManager","deviceManager","createLocal","getInfo","version","git","site","description","author","getFPSManager","getSceneManager","getLayerManager","getTextureManager","getAudioManager","getPaintManager","paint","getIO","getDOMManager","getTriggerManager","getMathManager","getGameStateManager","getViewManager","getErrorManager","getTimeManager","getResourceManager","setWindow","setFrameLimit","_state","end","lastTime","gameEngine","setTimeout","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame"],"mappings":"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","file":"j2ds.js","sourcesContent":["/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.4\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('utils/MathUtil', [], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        factory();\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function () {\r\n    \"use strict\";\r\n\r\n    /**\r\n     * Вспомогательный класс содержащий статичные методы для облегчения расчетов.\r\n     *\r\n     * @class MathUtil\r\n     * @exports module:utils/MathUtil\r\n     *\r\n     * @constructor\r\n     */\r\n    var MathUtil = function () {\r\n    };\r\n\r\n    /**\r\n     * Вектор\r\n     *\r\n     * @param {number} x\r\n     * @param {number} y\r\n     * @returns {{x: number, y: number}}\r\n     */\r\n    MathUtil.v2f = function (x, y) {\r\n        return {x: x, y: y};\r\n    };\r\n\r\n    /**\r\n     * Целочисленный вектор\r\n     *\r\n     * @param {number} x\r\n     * @param {number} y\r\n     * @returns {{x: number, y: number}}\r\n     */\r\n    MathUtil.v2i = function (x, y) {\r\n        return {x: (x >> 0), y: (y >> 0)};\r\n    };\r\n\r\n    /**\r\n     * Приведение типа числа к целочисленному\r\n     *\r\n     * @alias parseInt()\r\n     * @param number\r\n     * @returns {number}\r\n     */\r\n    MathUtil.toInt = function (number) {\r\n        return number >> 0;\r\n    };\r\n\r\n    /**\r\n     * Случайный цвет\r\n     *\r\n     * @param {number} min 0..256\r\n     * @param {number} max 0..256\r\n     * @param {number} opacity 0.0 ~ 1.0\r\n     * @returns {string} rgba(0..256, 0..256, 0..256, 0.0 ~ 1.0)\r\n     */\r\n    MathUtil.rndColor = function (min, max, opacity) {\r\n        return 'rgba('\r\n            + MathUtil.random(min, max) + ', '\r\n            + MathUtil.random(min, max) + ', '\r\n            + MathUtil.random(min, max) + ', '\r\n            + opacity + ')';\r\n    };\r\n\r\n    /**\r\n     * Случайное число\r\n     *\r\n     * @param min Минимальное\r\n     * @param max Максимальное\r\n     * @param omitZero Включая нуль?\r\n     * @returns {number}\r\n     */\r\n    MathUtil.random = function (min, max, omitZero) {\r\n        var random = (Math.floor(Math.random() * (max - min + 1) + min));\r\n        return (omitZero && random == 0)\r\n            ? MathUtil.random(min, max, omitZero)\r\n            : random;\r\n    };\r\n\r\n    /**\r\n     * Приведение градусов в радианы\r\n     *\r\n     * @param {number} num 0..360\r\n     * @returns {number}\r\n     */\r\n    MathUtil.rad = function (num) {\r\n        return num * (Math.PI / 180);\r\n    };\r\n\r\n    /**\r\n     * Проверка пересечения отрезков вершин двух фигур\r\n     *\r\n     * @param {Array.<{x: number, y: number}>} a\r\n     * @param {Array.<{x: number, y: number}>} b\r\n     * @returns {boolean}\r\n     */\r\n    MathUtil.is4VerticesIntersect = function (a, b) {\r\n        var m, n;\r\n        for (m = 0; m < a.length; m++) {\r\n            for (n = 0; n < b.length; n++) {\r\n                if (MathUtil.isLineIntersect(\r\n                        a[m],\r\n                        a[(m < a.length - 1) ? m + 1 : 0],\r\n                        b[n],\r\n                        b[(n < b.length - 1) ? n + 1 : 0])\r\n                ) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * Проверка пересечения отрезков\r\n     *\r\n     * @param {{x: number, y: number}} a Начальная точка первого отрезка\r\n     * @param {{x: number, y: number}} b Конечная точка первого отрезка\r\n     * @param {{x: number, y: number}} c Начальная точка второго отрезка\r\n     * @param {{x: number, y: number}} d Конечная точка второго отрезка\r\n     * @returns {boolean}\r\n     */\r\n    MathUtil.isLineIntersect = function (a, b, c, d) {\r\n        var dx, g, l;\r\n        dx = (b.x - a.x) * (d.y - c.y) - (d.x - c.x) * (b.y - a.y);\r\n        if (dx === 0) {\r\n            return false;\r\n        } else {\r\n            l = ((d.y - c.y) * (d.x - a.x) + (c.x - d.x) * (d.y - a.y)) / dx;\r\n            g = ((a.y - b.y) * (d.x - a.x) + (b.x - a.x) * (d.y - a.y)) / dx;\r\n            return (0 < l && l < 1) && (0 < g && g < 1);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Проверка принадлежности точки прямоугольнику\r\n     *\r\n     * @param {{x: number, y: number}} a 1-я вершина прямоугольника\r\n     * @param {{x: number, y: number}} b 2-я вершина прямоугольника\r\n     * @param {{x: number, y: number}} c 3-я вершина прямоугольника\r\n     * @param {{x: number, y: number}} d 4-я вершина прямоугольника\r\n     * @param {{x: number, y: number}} p Точка\r\n     * @returns {boolean}\r\n     */\r\n    MathUtil.isPointInRect = function (a, b, c, d, p) {\r\n        return MathUtil.isPointInTriangle(p, a, b, c) || MathUtil.isPointInTriangle(p, c, d, a);\r\n    };\r\n\r\n    /**\r\n     * Служебная функция для проверки принадлежности точки треугольнику\r\n     *\r\n     * @param {{x: number, y: number}} p1\r\n     * @param {{x: number, y: number}} p2\r\n     * @param {{x: number, y: number}} p3\r\n     * @returns {number}\r\n     */\r\n    var sign = function (p1, p2, p3) {\r\n        return (p1.x - p3.x) * (p2.y - p3.y) - (p2.x - p3.x) * (p1.y - p3.y);\r\n    };\r\n\r\n    /**\r\n     * Проверка принадлежности точки треугольнику\r\n     *\r\n     * @param {{x: number, y: number}} pt Точка\r\n     * @param {{x: number, y: number}} a 1-я вершина прямоугольника\r\n     * @param {{x: number, y: number}} b 2-я вершина прямоугольника\r\n     * @param {{x: number, y: number}} c 3-я вершина прямоугольника\r\n     * @returns {boolean}\r\n     */\r\n    MathUtil.isPointInTriangle = function (pt, a, b, c) {\r\n        var b1, b2, b3;\r\n        b1 = sign(pt, a, b) < 0;\r\n        b2 = sign(pt, b, c) < 0;\r\n        b3 = sign(pt, c, a) < 0;\r\n\r\n        return ((b1 == b2) && (b2 == b3));\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.MathUtil = MathUtil;\r\n    if (global.j2Ds !== undefined) global.modules.utils.MathUtil = MathUtil;\r\n    return MathUtil;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.3\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('utils/TextureUtil', [], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        factory();\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function () {\r\n    \"use strict\";\r\n\r\n    /**\r\n     * Вспомогательный класс содержащий методы для генерации текстур.\r\n     *\r\n     * @class TextureUtil\r\n     * @exports module:utils/TextureUtil\r\n     *\r\n     * @constructor\r\n     */\r\n    var TextureUtil = function (j2Ds) {\r\n        this.j2Ds = j2Ds;\r\n    };\r\n\r\n    /**\r\n     * Создает карту текстур\r\n     *\r\n     * @param {number} width\r\n     * @param {number} height\r\n     * @param {function} callback\r\n     * @returns {{img: null|Element, loaded: boolean, width: number, height: number}}\r\n     */\r\n    TextureUtil.prototype.createImageMap = function (width, height, callback) {\r\n        var textureUtil = this;\r\n        textureUtil.j2Ds.resources.add();\r\n        var image = {\r\n            /** @type null|Element */\r\n            img: null,\r\n            loaded: false,\r\n            width: width,\r\n            height: height\r\n        };\r\n\r\n        image.img = document.createElement('canvas');\r\n        image.context = image.img.getContext('2d');\r\n        image.img.width = image.width;\r\n        image.img.height = image.height;\r\n\r\n        callback(image.context);\r\n        image.loaded = true;\r\n\r\n        /**\r\n         * Возвращает анимацию\r\n         *\r\n         * @param {number} sourceX\r\n         * @param {number} sourceY\r\n         * @param {number} sourceW\r\n         * @param {number} sourceH\r\n         * @param {number} frameCount\r\n         * @returns {{imageMap: image, sourceX: number, sourceY: number, sourceW: number, sourceH: number, frameCount: number}}\r\n         */\r\n        image.getAnimation = function (sourceX, sourceY, sourceW, sourceH, frameCount) {\r\n            return {\r\n                imageMap: this,\r\n                sourceX: sourceX,\r\n                sourceY: sourceY,\r\n                sourceW: sourceW,\r\n                sourceH: sourceH,\r\n                frameCount: frameCount - 1\r\n            };\r\n        };\r\n\r\n        textureUtil.j2Ds.resources.ok('createImageMap_' + width + 'x' + height);\r\n\r\n        return image;\r\n    };\r\n\r\n    /**\r\n     * Загружает из файла карту текстур\r\n     *\r\n     * @param {string} path\r\n     * @returns {{img: null, width: number, height: number, loaded: boolean}}\r\n     */\r\n    TextureUtil.prototype.loadImageMap = function (path) {\r\n        var textureUtil = this;\r\n        textureUtil.j2Ds.resources.add();\r\n        var image = {\r\n            /** @type null|Element */\r\n            img: null,\r\n            width: 0,\r\n            height: 0,\r\n            loaded: false\r\n        };\r\n\r\n        image.img = document.createElement('img');\r\n        image.crossOrigin = 'anonymous';\r\n        image.img.src = path;\r\n\r\n        image.img.addEventListener('load', function () {\r\n            image.width = image.img.width;\r\n            image.height = image.img.height;\r\n            image.loaded = true;\r\n            textureUtil.j2Ds.resources.ok(path);\r\n        });\r\n\r\n        image.img.addEventListener('error', function () {\r\n            image.width = 0;\r\n            image.height = 0;\r\n            image.loaded = false;\r\n            //textureUtil.j2Ds.resources.fail(path);\r\n        });\r\n        /* Свойства */\r\n\r\n        /**\r\n         * Возвращает анимацию\r\n         *\r\n         * @param {number} sourceX\r\n         * @param {number} sourceY\r\n         * @param {number} sourceW\r\n         * @param {number} sourceH\r\n         * @param {number} frameCount\r\n         * @returns {{imageMap: image, sourceX: number, sourceY: number, sourceW: number, sourceH: number, frameCount: number}}\r\n         */\r\n        image.getAnimation = function (sourceX, sourceY, sourceW, sourceH, frameCount) {\r\n            return {\r\n                imageMap: this,\r\n                sourceX: sourceX,\r\n                sourceY: sourceY,\r\n                sourceW: sourceW,\r\n                sourceH: sourceH,\r\n                frameCount: frameCount - 1\r\n            };\r\n        };\r\n\r\n        return image;\r\n    };\r\n\r\n    /* -------------------- */\r\n\r\n    /**\r\n     * Шаблоны\r\n     *\r\n     * @type {{ellipse: TextureUtil.templates.ellipse, fillRect: TextureUtil.templates.fillRect, strokeRect: TextureUtil.templates.strokeRect, gradientL: TextureUtil.templates.gradientL, gradientR: TextureUtil.templates.gradientR}}\r\n     */\r\n    TextureUtil.prototype.templates = {\r\n        /**\r\n         * Рисует эллипс\r\n         *\r\n         * @param {CanvasRenderingContext2D} context\r\n         * @param {number} size\r\n         * @param {string} color\r\n         */\r\n        ellipse: function (context, size, color) { // TODO??\r\n        },\r\n\r\n        /**\r\n         * Рисует прямоугольник закрашенный\r\n         *\r\n         * @param {CanvasRenderingContext2D} context\r\n         * @param {number} size\r\n         * @param {string} color\r\n         */\r\n        fillRect: function (context, size, color) {\r\n            context.fillStyle = color;\r\n            context.fillRect(0, 0, size.x, size.y);\r\n        },\r\n\r\n        /**\r\n         * Рисует пустой прямоугольник\r\n         *\r\n         * @param {CanvasRenderingContext2D} context\r\n         * @param {number} size\r\n         * @param {string} color\r\n         * @param {number} lineWidth\r\n         */\r\n        strokeRect: function (context, size, color, lineWidth) {\r\n            context.strokeStyle = color;\r\n            context.lineWidth = lineWidth;\r\n            context.strokeRect(0, 0, size.x, size.y);\r\n        },\r\n\r\n        /**\r\n         * Рисует линейным градиентом\r\n         *\r\n         * @param {CanvasRenderingContext2D} context\r\n         * @param {number} size\r\n         * @param {Array.<string>} colors\r\n         * @param {boolean} isHorizontal\r\n         */\r\n        gradientL: function (context, size, colors, isHorizontal) {\r\n            var gradient = context.createLinearGradient(0, 0, size.x, 0);\r\n            var step = 1 / colors.length;\r\n            if (!isHorizontal) {\r\n                gradient = context.createLinearGradient(0, 0, 0, size.y);\r\n            }\r\n            for (var i = step / 2, j = 0; j < colors.length; j += 1, i += step) {\r\n                gradient.addColorStop(i, colors[j]);\r\n            }\r\n            context.fillStyle = gradient;\r\n            context.fillRect(0, 0, size.x, size.y);\r\n        },\r\n\r\n        /**\r\n         * Рисует радиальным градиентом\r\n         *\r\n         * @param {CanvasRenderingContext2D} context\r\n         * @param {{x: number, y: number}} size\r\n         * @param {{x: number, y: number}} pos1\r\n         * @param {number} r1\r\n         * @param {{x: number, y: number}} pos2\r\n         * @param {number} r2\r\n         * @param {Array.<string>} colors\r\n         */\r\n        gradientR: function (context, size, pos1, r1, pos2, r2, colors) {\r\n            var gradient = context.createRadialGradient(pos1.x, pos1.y, r1, pos2.x, pos2.y, r2);\r\n            var step = 1 / colors.length;\r\n            for (var i = step / 2, j = 0; j < colors.length; j += 1, i += step) {\r\n                gradient.addColorStop(i, colors[j]);\r\n            }\r\n            context.fillStyle = gradient;\r\n            context.fillRect(0, 0, size.x, size.y);\r\n        }\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.TextureUtil = TextureUtil;\r\n    if (global.j2Ds !== undefined) global.modules.utils.TextureUtil = TextureUtil;\r\n    return TextureUtil;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('core/Dom', [], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        factory();\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function () {\r\n    \"use strict\";\r\n\r\n    /*----------- DOM ---------------*/\r\n    var Dom = function (j2Ds) {\r\n        this.j2Ds = j2Ds;\r\n    };\r\n\r\n    Dom.prototype.id = function (id) {\r\n        return document.getElementById(id);\r\n    };\r\n\r\n    Dom.prototype.name = function (id) {\r\n        return document.getElementsByName(id)[0];\r\n    };\r\n\r\n    Dom.prototype.tag = function (id, parent) {\r\n        var finder = parent || document;\r\n        return finder.getElementsByTagName(id);\r\n    };\r\n\r\n    Dom.prototype.goURL = function (url) {\r\n        document.location.href = url;\r\n    };\r\n\r\n    Dom.prototype.reloadURL = function () {\r\n        document.location.href = document.location.href;\r\n    };\r\n\r\n    Dom.prototype.attach = function (id, parent) {\r\n        var dom = this;\r\n        this.j2Ds.events.addEvent('dom:loaded', function (parent) {\r\n            if (!parent) {\r\n                dom.tag('body')[0].appendChild(id);\r\n            } else {\r\n                dom.id(parent).appendChild(id);\r\n            }\r\n        });\r\n    };\r\n\r\n    Dom.prototype.injectJavaScript = function (code) {\r\n        code = code.toString();\r\n        code = code.replace(/[\\n\\r\\t]/g, ';');\r\n        document.location.href = 'javascript: var injectFunction = (function() {setTimeout(' + code + ', 0);}); injectFunction();';\r\n    };\r\n\r\n    Dom.prototype.callJava = function (code) {\r\n        document.location.href = 'javacall:' + code;\r\n    };\r\n\r\n    Dom.prototype.send = function (path, callback) {\r\n        var ajax = new XMLHttpRequest();\r\n        ajax.open('GET', path, true);\r\n        ajax.onreadystatechange = function () {\r\n            if (ajax.readyState == 4) {\r\n                if (ajax.status == 200) {\r\n                    callback(ajax.responseText);\r\n                }\r\n            }\r\n        };\r\n        ajax.send(null);\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.Dom = Dom;\r\n    if (global.j2Ds !== undefined) global.modules.core.Dom = Dom;\r\n    return Dom;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('core/Gui', [], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        factory();\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function () {\r\n    \"use strict\";\r\n\r\n    /*----------- GUI ---------------*/\r\n    var Gui = function () {\r\n        this.nodes = {};\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.Gui = Gui;\r\n    if (global.j2Ds !== undefined) global.modules.core.Gui = Gui;\r\n    return Gui;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('core/Events', [], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        factory();\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function () {\r\n    \"use strict\";\r\n\r\n    var Events = function (j2Ds) {\r\n        this.j2Ds = j2Ds;\r\n        this.events = {\r\n            'scene:deactivate': [],\r\n            'scene:activate': [],\r\n\r\n            'scene:beforeInit': [],\r\n            'scene:afterInit': [],\r\n            'scene:beforeStart': [],\r\n            'scene:afterStart': [],\r\n\r\n            'engine:before': [],\r\n            'engine:after': [],\r\n\r\n            'scene:changedGameState': [],\r\n\r\n            'writeMode:keyPress': [],\r\n\r\n            'dom:loaded': []\r\n        };\r\n    };\r\n\r\n\r\n    Events.prototype.addEvent = function (eventType, callback, id) {\r\n        this.events[eventType].push({\r\n            id: id || this.j2Ds.now,\r\n            callback: callback\r\n        });\r\n        if (this.j2Ds.ready && eventType == 'dom:loaded') {\r\n            this.onEvent('dom:loaded');\r\n            return true;\r\n        }\r\n    };\r\n\r\n    Events.prototype.destroyEvent = function (eventType, id) {\r\n        var events = this;\r\n        for (var i = 0, len = events.events[eventType].length; i < len; i += 1) {\r\n            if (events.events[eventType][i]['id'] == id) {\r\n                events.events[eventType].splice(i, 1);\r\n            }\r\n        }\r\n    };\r\n\r\n    Events.prototype.onEvent = function (eventType, args) {\r\n        var events = this;\r\n        for (var i = 0, len = events.events[eventType].length; i < len; i += 1) {\r\n            if (events.events[eventType]) {\r\n                try {\r\n                    events.events[eventType][i]['callback'](args || '');\r\n                } catch (err) {\r\n                    events.j2Ds.errorManager.showError(err);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.Events = Events;\r\n    if (global.j2Ds !== undefined) global.modules.core.Events = Events;\r\n    return Events;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.4\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('nodes/BaseNode', ['utils/MathUtil'], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory(require('utils/MathUtil'));\r\n    } else {\r\n        factory(root.modules.utils.MathUtil);\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function (MathUtil) {\r\n    \"use strict\";\r\n\r\n    var j2Ds;\r\n\r\n    /**\r\n     * @exports module:nodes/BaseNode\r\n     */\r\n    var BaseNode;\r\n\r\n    /**\r\n     * Базовый класс о общими методами для всех узлов.\r\n     *\r\n     * @class BaseNode\r\n     * @alias module:nodes/BaseNode\r\n     *\r\n     * @abstract\r\n     * @constructor\r\n     * @param {j2DsEngine} j2DsEngine\r\n     * @param {{x: number, y: number}} pos\r\n     * @param {{x: number, y: number}} size\r\n     *\r\n     * @property {boolean} visible\r\n     * @property {number} alpha\r\n     * @property {{x: number, y: number}} pos\r\n     * @property {{x: number, y: number}} size\r\n     * @property {boolean} parent\r\n     * @property {number} angle\r\n     * @property {core/Scene} layer\r\n     * @property {{offset: {x: number, y: number}, size: {x: number, y: number}}} box\r\n     */\r\n    BaseNode = function (j2DsEngine, pos, size) {\r\n        j2Ds = j2DsEngine;\r\n        this.visible = true;\r\n        this.alpha = 1;\r\n        this.pos = pos;\r\n        this.size = size;\r\n        this.parent = false;\r\n        this.angle = 0;\r\n        this.layer = j2Ds.scene;\r\n        this.box = {\r\n            offset: {\r\n                x: 0,\r\n                y: 0\r\n            },\r\n            size: {\r\n                x: 0,\r\n                y: 0\r\n            }\r\n        };\r\n        j2Ds.scene.nodes.push(this);\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param {{x: number, y: number}} offset\r\n     * @param {{x: number, y: number}} size\r\n     */\r\n    BaseNode.prototype.resizeBox = function (offset, size) {\r\n        this.box.offset = offset;\r\n        this.box.size = size;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param layer\r\n     */\r\n    BaseNode.prototype.setLayer = function (layer) {\r\n        this.layer = layer ? j2Ds.layers.layer(layer) : j2Ds.scene;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @returns {*}\r\n     */\r\n    BaseNode.prototype.getLayer = function () {\r\n        return this.layer;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param visible\r\n     */\r\n    BaseNode.prototype.setVisible = function (visible) {\r\n        this.visible = !!visible;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @returns {boolean|*}\r\n     */\r\n    BaseNode.prototype.isVisible = function () {\r\n        return this.visible;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param alpha\r\n     */\r\n    BaseNode.prototype.setAlpha = function (alpha) {\r\n        if (alpha < 0) alpha = 0;\r\n        if (alpha > 1) alpha = 1;\r\n        this.alpha = alpha;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @returns {*|number}\r\n     */\r\n    BaseNode.prototype.getAlpha = function () {\r\n        return this.alpha;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param to\r\n     * @param t\r\n     */\r\n    BaseNode.prototype.moveTo = function (to, t) {\r\n        t = t ? t : 1;\r\n        this.move(MathUtil.v2f(\r\n            ((to.x - this.getPosition().x) / t),\r\n            ((to.y - this.getPosition().y) / t)\r\n        ));\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param pos\r\n     * @returns {*}\r\n     */\r\n    BaseNode.prototype.setPosition = function (pos) {\r\n        if (pos) {\r\n            this.pos = MathUtil.v2f(pos.x - Math.ceil(this.size.x / 2), pos.y - Math.ceil(this.size.y / 2));\r\n        } else {\r\n            return this.pos;\r\n        }\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param pos\r\n     */\r\n    BaseNode.prototype.move = function (pos) {\r\n        this.pos.x += pos.x;\r\n        this.pos.y += pos.y;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @returns {{x, y}|{x: number, y: number}}\r\n     */\r\n    BaseNode.prototype.getPosition = function () {\r\n        return MathUtil.v2f(this.pos.x + Math.ceil(this.size.x / 2), this.pos.y + Math.ceil(this.size.y / 2));\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param size\r\n     * @returns {*}\r\n     */\r\n    BaseNode.prototype.setSize = function (size) {\r\n        if (size) {\r\n            this.size = size;\r\n        } else {\r\n            return this.size;\r\n        }\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @returns {*}\r\n     */\r\n    BaseNode.prototype.getSize = function () {\r\n        return this.size;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param id\r\n     */\r\n    BaseNode.prototype.setParent = function (id) {\r\n        this.parent = id;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param id\r\n     * @returns {number}\r\n     */\r\n    BaseNode.prototype.getDistance = function (id) {\r\n        return Math.ceil(Math.sqrt(\r\n                Math.pow(id.getPosition().x - this.getPosition().x, 2) +\r\n                Math.pow(id.getPosition().y - this.getPosition().y, 2)\r\n            )\r\n        );\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param id\r\n     * @returns {{x, y}|{x: number, y: number}}\r\n     */\r\n    BaseNode.prototype.getDistanceXY = function (id) {\r\n        return MathUtil.v2f(Math.abs(id.getPosition().x - this.getPosition().x), Math.abs(id.getPosition().y - this.getPosition().y));\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param node\r\n     * @returns {{x1: *, x2: *, y1: *, y2: *}}\r\n     */\r\n    BaseNode.prototype.getBox = function (node) {\r\n        return {\r\n            x1: node.pos.x + node.box.offset.x,\r\n            x2: node.pos.x + node.box.offset.x + node.size.x + node.box.size.x,\r\n            y1: node.pos.y + node.box.offset.y,\r\n            y2: node.pos.y + node.box.offset.y + node.size.y + node.box.size.y\r\n        }\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param {BaseNode} node\r\n     * @returns {Array.<{x: number, y: number}>}\r\n     */\r\n    BaseNode.prototype.getBoxVertices = function (node) {\r\n        if (node === undefined) node = this;\r\n        var angle = -MathUtil.rad(node.angle);\r\n\r\n        var dx = node.box.offset.x + node.box.size.x / 2 + node.getPosition().x - j2Ds.scene.view.pos.x;\r\n        var dy = node.box.offset.y + node.box.size.y / 2 + node.getPosition().y - j2Ds.scene.view.pos.y;\r\n\r\n        var box = this.getBox(node);\r\n\r\n        return [\r\n            {\r\n                x: (dx + (box.y1 - dy) * Math.sin(angle) + (box.x2 - dx) * Math.cos(angle)).toFixed(5),\r\n                y: (dy + (box.y1 - dy) * Math.cos(angle) - (box.x2 - dx) * Math.sin(angle)).toFixed(5)\r\n            },\r\n            {\r\n                x: (dx + (box.y2 - dy) * Math.sin(angle) + (box.x2 - dx) * Math.cos(angle)).toFixed(5),\r\n                y: (dy + (box.y2 - dy) * Math.cos(angle) - (box.x2 - dx) * Math.sin(angle)).toFixed(5)\r\n            },\r\n            {\r\n                x: (dx + (box.y2 - dy) * Math.sin(angle) + (box.x1 - dx) * Math.cos(angle)).toFixed(5),\r\n                y: (dy + (box.y2 - dy) * Math.cos(angle) - (box.x1 - dx) * Math.sin(angle)).toFixed(5)\r\n            },\r\n            {\r\n                x: (dx + (box.y1 - dy) * Math.sin(angle) + (box.x1 - dx) * Math.cos(angle)).toFixed(5),\r\n                y: (dy + (box.y1 - dy) * Math.cos(angle) - (box.x1 - dx) * Math.sin(angle)).toFixed(5)\r\n            }\r\n        ]\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param node1\r\n     * @param node2\r\n     * @returns {*}\r\n     */\r\n    var checkBoxIntersect = function (node1, node2) {\r\n        var a, b;\r\n        if (node1.angle === 0 && node2.angle === 0) {\r\n            a = node1.getBox(node1);\r\n            b = node1.getBox(node2);\r\n\r\n            return !(a.y1 > b.y2 || a.y2 < b.y1 || a.x2 < b.x1 || a.x1 > b.x2);\r\n        } else {\r\n            a = node1.getBoxVertices(node1);\r\n            b = node1.getBoxVertices(node2);\r\n\r\n            if (!MathUtil.is4VerticesIntersect(a, b)) {\r\n                return node1.isPointInsideBox(a, node2.getPosition())\r\n                    || node2.isPointInsideBox(b, node1.getPosition());\r\n            }\r\n            return true;\r\n        }\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param vf\r\n     * @param point\r\n     * @returns {boolean}\r\n     */\r\n    BaseNode.prototype.isPointInsideBox = function (vf, point) {\r\n        return MathUtil.isPointInRect(vf[0], vf[1], vf[2], vf[3], point);\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param node2\r\n     * @returns {*}\r\n     */\r\n    BaseNode.prototype.isIntersect = function (node2) {\r\n        var node1 = this;\r\n\r\n        if (node2 instanceof BaseNode) {\r\n            return checkBoxIntersect(node1, node2);\r\n        } else if (node2 instanceof Array && node2.length > 0 && node2[0] instanceof BaseNode) {\r\n            for (var i = 0; i < node2.length; i++) {\r\n                if (checkBoxIntersect(node1, node2[i])) return true;\r\n            }\r\n            return false;\r\n        }\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param id\r\n     * @returns {boolean}\r\n     */\r\n    BaseNode.prototype.isCollision = function (id) {\r\n        var result = false;\r\n        if (\r\n            (this.getDistanceXY(id).x < (this.size.x / 2 + id.size.x / 2)) &&\r\n            (this.getDistanceXY(id).y < (this.size.y / 2 + id.size.y / 2))\r\n        ) {\r\n            result = true;\r\n        }\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    BaseNode.prototype.isLookScene = function () {\r\n        return !((this.pos.x > j2Ds.scene.view.pos.x + j2Ds.scene.width || this.pos.x + this.size.x < j2Ds.scene.view.pos.x)\r\n        || (this.pos.y > j2Ds.scene.view.pos.y + j2Ds.scene.height || this.pos.y + this.size.y < j2Ds.scene.view.pos.y));\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param angle\r\n     */\r\n    BaseNode.prototype.turn = function (angle) {\r\n        this.angle = (this.angle % 360);\r\n        this.angle += angle;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param angle\r\n     */\r\n    BaseNode.prototype.setRotation = function (angle) {\r\n        this.angle = angle % 360;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @returns {number|*}\r\n     */\r\n    BaseNode.prototype.getRotation = function () {\r\n        return this.angle;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param to\r\n     * @param t\r\n     */\r\n    BaseNode.prototype.rotateTo = function (to, t) {\r\n        t = t ? t : 1;\r\n        this.setRotation((Math.atan2(\r\n                (to.y - this.getPosition().y),\r\n                (to.x - this.getPosition().x)\r\n            ) * (180 / Math.PI)) / t);\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @returns {{}}\r\n     */\r\n    BaseNode.prototype.isOutScene = function () {\r\n        var vector = {};\r\n\r\n        if (this.pos.x + this.size.x >= j2Ds.scene.view.pos.x + j2Ds.scene.width) {\r\n            vector.x = 1;\r\n        } else if (this.pos.x <= j2Ds.scene.view.pos.x) {\r\n            vector.x = -1;\r\n        } else {\r\n            vector.x = 0;\r\n        }\r\n\r\n        if (this.pos.y + this.size.y >= j2Ds.scene.view.pos.y + j2Ds.scene.height) {\r\n            vector.y = 1;\r\n        } else if (this.pos.y <= j2Ds.scene.view.pos.y) {\r\n            vector.y = -1;\r\n        } else {\r\n            vector.y = 0;\r\n        }\r\n\r\n        vector.all = (vector.x || vector.y);\r\n\r\n        return vector;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param speed\r\n     */\r\n    BaseNode.prototype.moveDir = function (speed) {\r\n        this.pos.x += speed * (Math.cos(MathUtil.rad(this.angle)));\r\n        this.pos.y += speed * (Math.sin(MathUtil.rad(this.angle)));\r\n    };\r\n\r\n    /**\r\n     *\r\n     */\r\n    BaseNode.prototype.drawBox = function () {\r\n        var context = this.layer.context;\r\n\r\n        context.lineWidth = 2;\r\n        context.strokeStyle = 'black';\r\n\r\n        if (this.angle) {\r\n            context.save();\r\n            context.translate(\r\n                this.getPosition().x - j2Ds.scene.view.pos.x,\r\n                this.getPosition().y - j2Ds.scene.view.pos.y\r\n            );\r\n            context.rotate(MathUtil.rad(this.angle));\r\n            context.translate(\r\n                -(this.getPosition().x - j2Ds.scene.view.pos.x),\r\n                -(this.getPosition().y - j2Ds.scene.view.pos.y)\r\n            );\r\n        }\r\n\r\n        context.beginPath();\r\n        context.rect(\r\n            this.pos.x - j2Ds.scene.view.pos.x,\r\n            this.pos.y - j2Ds.scene.view.pos.y,\r\n            this.size.x, this.size.y);\r\n        context.stroke();\r\n\r\n        if (this.angle) {\r\n            context.restore();\r\n            context.save();\r\n            context.translate(\r\n                this.box.offset.x + this.box.size.x / 2 + this.getPosition().x - j2Ds.scene.view.pos.x,\r\n                this.box.offset.y + this.box.size.y / 2 + this.getPosition().y - j2Ds.scene.view.pos.y\r\n            );\r\n            context.rotate(MathUtil.rad(this.angle));\r\n            context.translate(\r\n                -(this.box.offset.x + this.box.size.x / 2 + this.getPosition().x - j2Ds.scene.view.pos.x),\r\n                -(this.box.offset.y + this.box.size.y / 2 + this.getPosition().y - j2Ds.scene.view.pos.y)\r\n            );\r\n        }\r\n\r\n        context.strokeStyle = 'yellow';\r\n\r\n        context.beginPath();\r\n        context.rect(\r\n            this.box.offset.x + this.pos.x - j2Ds.scene.view.pos.x,\r\n            this.box.offset.y + this.pos.y - j2Ds.scene.view.pos.y,\r\n            this.box.size.x + this.size.x,\r\n            this.box.size.y + this.size.y);\r\n        context.stroke();\r\n\r\n        if (this.angle) {\r\n            context.restore();\r\n        }\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.BaseNode = BaseNode;\r\n    if (global.j2Ds !== undefined) global.modules.nodes.BaseNode = BaseNode;\r\n    return BaseNode;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('nodes/CircleNode', ['nodes/BaseNode', 'utils/MathUtil'], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory(require('nodes/BaseNode'), require('utils/MathUtil'));\r\n    } else {\r\n        factory(root.modules.nodes.BaseNode, root.modules.utils.MathUtil);\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function (BaseNode, MathUtil) {\r\n    \"use strict\";\r\n\r\n    var j2Ds;\r\n\r\n    /**\r\n     * @exports module:nodes/CircleNode\r\n     */\r\n    var CircleNode;\r\n\r\n    /**\r\n     * Примитивный узел для отрисовки круга.\r\n     *\r\n     * @class CircleNode\r\n     *\r\n     * @constructor\r\n     * @extends module:nodes/BaseNode\r\n     * @param {j2DsEngine} j2DsEngine\r\n     * @param {{x: number, y: number}} pos\r\n     * @param {number} radius\r\n     * @param {string} color\r\n     *\r\n     * @property {string} color\r\n     * @property {number} radius\r\n     */\r\n    CircleNode = function (j2DsEngine, pos, radius, color) {\r\n        j2Ds = j2DsEngine;\r\n        BaseNode.call(this, j2DsEngine, pos, MathUtil.v2f(radius * 2, radius * 2));\r\n\r\n        /*Свойства*/\r\n        this.color = color;\r\n        this.radius = radius;\r\n    };\r\n\r\n    CircleNode.prototype = Object.create(BaseNode.prototype);\r\n    CircleNode.prototype.constructor = CircleNode;\r\n\r\n    /**\r\n     * Метод для отрисовки узла\r\n     */\r\n    CircleNode.prototype.draw = function () {\r\n        var context = this.layer.context;\r\n        if (this.visible && this.isLookScene()) {\r\n            if (this.alpha != 1) {\r\n                var tmpAlpha = context.globalAlpha;\r\n                context.globalAlpha = this.alpha;\r\n            }\r\n            context.lineWidth = 0;\r\n            context.fillStyle = this.color;\r\n\r\n            context.beginPath();\r\n            context.arc(this.pos.x - j2Ds.scene.view.pos.x + this.radius,\r\n                this.pos.y - j2Ds.scene.view.pos.y + this.radius,\r\n                this.radius, 0, 2 * Math.PI, true);\r\n            context.stroke();\r\n            context.fill();\r\n\r\n            if (this.alpha != 1) {\r\n                context.globalAlpha = tmpAlpha;\r\n            }\r\n        }\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.CircleNode = CircleNode;\r\n    if (global.j2Ds !== undefined) global.modules.nodes.CircleNode = CircleNode;\r\n    return CircleNode;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('nodes/LineNode', ['nodes/BaseNode', 'utils/MathUtil'], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory(require('nodes/BaseNode'), require('utils/MathUtil'));\r\n    } else {\r\n        factory(root.modules.nodes.BaseNode, root.modules.utils.MathUtil);\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function (BaseNode, MathUtil) {\r\n    \"use strict\";\r\n\r\n    var j2Ds;\r\n\r\n    /**\r\n     * @exports module:nodes/LineNode\r\n     */\r\n    var LineNode;\r\n\r\n    /**\r\n     * Примитивный узел для отрисовки линии.\r\n     *\r\n     * @class LineNode\r\n     *\r\n     * @constructor\r\n     * @extends module:nodes/BaseNode\r\n     * @param {j2DsEngine} j2DsEngine\r\n     * @param {{x: number, y: number}} pos\r\n     * @param {Array.<Array.<number>>} points\r\n     * @param {number} scale\r\n     * @param {string} color\r\n     * @param {number} width\r\n     * @param {boolean} fill\r\n     * @param {string} cFill\r\n     * \r\n     * @property {string} color\r\n     * @property {Array.<Array.<number>>} points\r\n     * @property {boolean} fill\r\n     * @property {number} scale\r\n     * @property {string} cFill\r\n     * @property {number} lineWidth\r\n     */\r\n    LineNode = function (j2DsEngine, pos, points, scale, color, width, fill, cFill) {\r\n        j2Ds = j2DsEngine;\r\n        BaseNode.call(this, j2DsEngine, pos, MathUtil.v2f(0, 0));\r\n\r\n        /*Свойства*/\r\n        this.color = color;\r\n        this.points = points;\r\n        this.fill = !!fill || false;\r\n        this.scale = scale || 0;\r\n        this.cFill = cFill;\r\n        this.lineWidth = width;\r\n    };\r\n\r\n    LineNode.prototype = Object.create(BaseNode.prototype);\r\n    LineNode.prototype.constructor = LineNode;\r\n\r\n    /**\r\n     * Метод для отрисовки узла\r\n     */\r\n    LineNode.prototype.draw = function () {\r\n        var context = this.layer.context;\r\n        if (this.visible && this.isLookScene()) {\r\n\r\n            if (this.alpha != 1) {\r\n                var tmpAlpha = context.globalAlpha;\r\n                context.globalAlpha = this.alpha;\r\n            }\r\n\r\n            context.strokeStyle = this.color;\r\n            context.lineWidth = this.lineWidth;\r\n\r\n            context.beginPath();\r\n            context.moveTo(this.pos.x - j2Ds.scene.view.pos.x,\r\n                this.pos.y - j2Ds.scene.view.pos.y);\r\n\r\n            for (var i = 0, len = this.points.length; i < len; i += 1) {\r\n                context.lineTo(\r\n                    this.pos.x + this.points[i][0] * this.scale - j2Ds.scene.view.pos.x,\r\n                    this.pos.y + this.points[i][1] * this.scale - j2Ds.scene.view.pos.y);\r\n            }\r\n\r\n            context.stroke();\r\n            if (this.fill) {\r\n                context.fillStyle = this.cFill;\r\n                context.fill();\r\n            }\r\n\r\n            context.lineWidth = 0;\r\n\r\n            if (this.alpha != 1) {\r\n                context.globalAlpha = tmpAlpha;\r\n            }\r\n        }\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.LineNode = LineNode;\r\n    if (global.j2Ds !== undefined) global.modules.nodes.LineNode = LineNode;\r\n    return LineNode;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('nodes/RectNode', ['nodes/BaseNode', 'utils/MathUtil'], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory(require('nodes/BaseNode'), require('utils/MathUtil'));\r\n    } else {\r\n        factory(root.modules.nodes.BaseNode, root.modules.utils.MathUtil);\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function (BaseNode, MathUtil) {\r\n    \"use strict\";\r\n\r\n    var j2Ds;\r\n\r\n    /**\r\n     * @exports module:nodes/RectNode\r\n     */\r\n    var RectNode;\r\n    \r\n    /**\r\n     * Примитивный узел для отрисовки прямоугольника.\r\n     *\r\n     * @class RectNode\r\n     *\r\n     * @constructor\r\n     * @extends module:nodes/BaseNode\r\n     *\r\n     * @param {j2DsEngine} j2DsEngine\r\n     * @param {{x: number, y: number}} pos\r\n     * @param {{x: number, y: number}} size\r\n     * @param {string} color\r\n     *\r\n     * @property {string} color\r\n     */\r\n    RectNode = function (j2DsEngine, pos, size, color) {\r\n        j2Ds = j2DsEngine;\r\n        BaseNode.call(this, j2DsEngine, pos, size);\r\n\r\n        this.color = color;\r\n    };\r\n\r\n    RectNode.prototype = Object.create(BaseNode.prototype);\r\n    RectNode.prototype.constructor = RectNode;\r\n\r\n    /**\r\n     * Метод для отрисовки узла\r\n     */\r\n    RectNode.prototype.draw = function () {\r\n        var context = this.layer.context;\r\n        if (this.visible && this.isLookScene()) {\r\n\r\n            if (this.alpha != 1) {\r\n                var tmpAlpha = context.globalAlpha;\r\n                context.globalAlpha = this.alpha;\r\n            }\r\n\r\n            if (this.angle) {\r\n                context.save();\r\n                context.translate(this.getPosition().x - j2Ds.scene.view.pos.x, this.getPosition().y - j2Ds.scene.view.pos.y);\r\n                context.rotate(MathUtil.rad(this.angle));\r\n                context.translate(-(this.getPosition().x - j2Ds.scene.view.pos.x), -(this.getPosition().y - j2Ds.scene.view.pos.y));\r\n            }\r\n\r\n            context.fillStyle = this.color;\r\n            context.lineWidth = 0;\r\n\r\n            context.fillRect(\r\n                this.pos.x - j2Ds.scene.view.pos.x,\r\n                this.pos.y - j2Ds.scene.view.pos.y,\r\n                this.size.x, this.size.y);\r\n\r\n            if (this.angle) {\r\n                context.restore();\r\n            }\r\n\r\n            if (this.alpha != 1) {\r\n                context.globalAlpha = tmpAlpha;\r\n            }\r\n        }\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.RectNode = RectNode;\r\n    if (global.j2Ds !== undefined) global.modules.nodes.RectNode = RectNode;\r\n    return RectNode;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('nodes/SpriteNode', ['nodes/BaseNode', 'utils/MathUtil'], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory(require('nodes/BaseNode'), require('utils/MathUtil'));\r\n    } else {\r\n        factory(root.modules.nodes.BaseNode, root.modules.utils.MathUtil);\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function (BaseNode, MathUtil) {\r\n    \"use strict\";\r\n\r\n    var j2Ds;\r\n\r\n    /**\r\n     * @exports module:nodes/SpriteNode\r\n     */\r\n    var SpriteNode;\r\n    \r\n    /**\r\n     * Примитивный узел для отрисовки спрайта.\r\n     *\r\n     * @class SpriteNode\r\n     *\r\n     * @constructor\r\n     * @extends module:nodes/BaseNode\r\n     * \r\n     * @param {j2DsEngine} j2DsEngine\r\n     * @param {{x: number, y: number}} pos\r\n     * @param {{x: number, y: number}} size\r\n     * @param {{imageMap: {img: null|Element, loaded: boolean, width: number, height: number}, sourceX: number, sourceY: number, sourceW: number, sourceH: number, frameCount: number}} animation\r\n     * \r\n     * @property {number} tmpSpeed\r\n     * @property {number} frame\r\n     * @property {{imageMap: {img: null|Element, loaded: boolean, width: number, height: number}, sourceX: number, sourceY: number, sourceW: number, sourceH: number, frameCount: number}} animation\r\n     * @property {{x: boolean|number, y: boolean|number}} flip\r\n     */\r\n    SpriteNode = function (j2DsEngine, pos, size, animation) {\r\n        j2Ds = j2DsEngine;\r\n        BaseNode.call(this, j2DsEngine, pos, size);\r\n\r\n        this.tmpSpeed = 0;\r\n        this.frame = 0;\r\n        this.animation = animation;\r\n        this.flip = {x: false, y: false};\r\n    };\r\n\r\n    SpriteNode.prototype = Object.create(BaseNode.prototype);\r\n    SpriteNode.prototype.constructor = SpriteNode;\r\n\r\n    /**\r\n     * //TODO Добавить описание этой херни\r\n     *\r\n     * @param {number} x\r\n     * @param {number} y\r\n     */\r\n    SpriteNode.prototype.setFlip = function (x, y) {\r\n        this.flip = {x: x, y: y};\r\n    };\r\n\r\n    /**\r\n     * Метод для отрисовки узла\r\n     */\r\n    SpriteNode.prototype.draw = function (speed) {\r\n        if (this.visible && this.isLookScene()) {\r\n            speed = speed || 1;\r\n\r\n            if (this.frame > this.animation.frameCount) {\r\n                this.frame = 0;\r\n            }\r\n            this.drawFrame(this.frame + 1);\r\n\r\n            if (this.tmpSpeed > speed) {\r\n                this.frame += 1;\r\n                this.tmpSpeed = 0;\r\n            }\r\n            else {\r\n                this.tmpSpeed += 1;\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Отрисовка одного кадра\r\n     *\r\n     * @param {number} frame\r\n     * @returns {void|{added, loaded, failed}}\r\n     */\r\n    SpriteNode.prototype.drawFrame = function (frame) {\r\n        if (!this.animation.imageMap.loaded) return (err.show('Invalid ImageMap', 'red'));\r\n        var context = this.layer.context;\r\n        if (this.visible && this.isLookScene()) {\r\n\r\n            if (this.alpha != 1) {\r\n                var tmpAlpha = context.globalAlpha;\r\n                context.globalAlpha = this.alpha;\r\n            }\r\n\r\n            context.lineWidth = 0;\r\n\r\n            if (this.angle || this.flip.x || this.flip.y) {\r\n                context.save();\r\n                context.translate(this.getPosition().x - j2Ds.scene.view.pos.x, this.getPosition().y - j2Ds.scene.view.pos.y);\r\n                context.rotate(MathUtil.rad(this.angle));\r\n                context.scale(this.flip.x ? -1 : 1, this.flip.y ? -1 : 1);\r\n                context.translate(-(this.getPosition().x - j2Ds.scene.view.pos.x), -(this.getPosition().y - j2Ds.scene.view.pos.y));\r\n            }\r\n\r\n            frame = frame ? (frame - 1) : 0;\r\n\r\n            context.drawImage(\r\n                this.animation.imageMap.img,\r\n                (this.animation.sourceX + (this.animation.sourceW * frame)), this.animation.sourceY,\r\n                this.animation.sourceW, this.animation.sourceH,\r\n                this.pos.x - j2Ds.scene.view.pos.x, this.pos.y - j2Ds.scene.view.pos.y,\r\n                this.size.x, this.size.y);\r\n\r\n            if (this.angle || this.flip.x || this.flip.y) {\r\n                context.restore();\r\n            }\r\n\r\n            if (this.alpha != 1) {\r\n                context.globalAlpha = tmpAlpha;\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Устанавливает анимацию\r\n     *\r\n     * @param {{imageMap: {img: null|Element, loaded: boolean, width: number, height: number}, sourceX: number, sourceY: number, sourceW: number, sourceH: number, frameCount: number}} animation\r\n     */\r\n    SpriteNode.prototype.setAnimation = function (animation) {\r\n        if (this.animation != animation) {\r\n            this.animation = animation;\r\n        }\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.SpriteNode = SpriteNode;\r\n    if (global.j2Ds !== undefined) global.modules.nodes.SpriteNode = SpriteNode;\r\n    return SpriteNode;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('nodes/TextNode', ['nodes/BaseNode', 'utils/MathUtil'], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory(require('nodes/BaseNode'), require('utils/MathUtil'));\r\n    } else {\r\n        factory(root.modules.nodes.BaseNode, root.modules.utils.MathUtil);\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function (BaseNode, MathUtil) {\r\n    \"use strict\";\r\n\r\n    var j2Ds;\r\n\r\n    /**\r\n     * @exports module:nodes/TextNode\r\n     */\r\n    var TextNode;\r\n    \r\n    /**\r\n     * Примитивный узел для отрисовки текста.\r\n     *\r\n     * @class TextNode\r\n     *\r\n     * @constructor\r\n     * @extends module:nodes/BaseNode\r\n     * \r\n     * @param {j2DsEngine} j2DsEngine\r\n     * @param {{x: number, y: number}} pos\r\n     * @param {string} text\r\n     * @param {number} sizePx\r\n     * @param {string} color\r\n     * @param {string} family\r\n     * @param {number} width\r\n     * @param {string} colorL\r\n     *\r\n     * @property {number} vAlign\r\n     * @property {number} hAlign\r\n     * @property {string} color\r\n     * @property {string} family\r\n     * @property {number} sizePx\r\n     * @property {number} lineWidth\r\n     * @property {string} colorL\r\n     * @property {string} font\r\n     * @property {string} fullText\r\n     * @property {number} maxWidth\r\n     * @property {Array.<string>} lines\r\n     */\r\n    TextNode = function (j2DsEngine, pos, text, sizePx, color, family, width, colorL) {\r\n        j2Ds = j2DsEngine;\r\n        BaseNode.call(this, j2DsEngine, pos, MathUtil.v2f(0, 0));\r\n\r\n        /*Свойства*/\r\n\r\n        this.vAlign = 'top';\r\n        this.hAlign = 'left';\r\n        this.color = color ? color : 'black';\r\n\r\n        this.family = family ? family : 'serif';\r\n        this.sizePx = sizePx ? sizePx : 20;\r\n\r\n        this.box.offset.y = MathUtil.toInt(this.sizePx * 0.26);\r\n        this.box.size.y = -MathUtil.toInt(this.sizePx * 0.26);\r\n\r\n        this.lineWidth = width ? width : 0;\r\n        this.colorL = colorL ? colorL : 'black';\r\n\r\n        this.font = this.sizePx + 'px ' + this.family;\r\n\r\n        this.fullText = text;\r\n        this.maxWidth = 0;\r\n        this.lines = text.split(\"\\n\");\r\n\r\n        j2Ds.scene.context.font = this.font;\r\n\r\n        for (var i = 0, len = this.lines.length; i < len; i += 1) {\r\n            this.maxWidth = (this.maxWidth < j2Ds.scene.context.measureText(this.lines[i]).width ?\r\n                j2Ds.scene.context.measureText(this.lines[i]).width :\r\n                this.maxWidth);\r\n        }\r\n\r\n        this.size.x = this.maxWidth;\r\n        this.size.y = this.lines.length * this.sizePx;\r\n    };\r\n\r\n    TextNode.prototype = Object.create(BaseNode.prototype);\r\n    TextNode.prototype.constructor = TextNode;\r\n\r\n    /**\r\n     * Устанавливает размер текста\r\n     *\r\n     * @param {number} sizePx\r\n     */\r\n    TextNode.prototype.setSize = function (sizePx) {\r\n        this.sizePx = sizePx;\r\n        this.font = this.sizePx + 'px ' + this.family;\r\n        j2Ds.scene.context.font = this.font;\r\n\r\n        this.box.offset.y = MathUtil.toInt(this.sizePx * 0.26);\r\n        this.box.size.y = -MathUtil.toInt(this.sizePx * 0.26);\r\n\r\n        for (var i = 0, len = this.lines.length; i < len; i += 1) {\r\n            this.maxWidth = (this.maxWidth < j2Ds.scene.context.measureText(this.lines[i]).width ?\r\n                j2Ds.scene.context.measureText(this.lines[i]).width :\r\n                this.maxWidth);\r\n        }\r\n        this.size.x = this.maxWidth;\r\n        this.size.y = this.lines.length * this.sizePx;\r\n    };\r\n\r\n    /**\r\n     * Возвращает текущий размер\r\n     *\r\n     * @returns {number}\r\n     */\r\n    TextNode.prototype.getSize = function () {\r\n        return this.sizePx;\r\n    };\r\n\r\n    /**\r\n     * Метод для быстрого изменения текста и его последующей отрисовки.\r\n     *\r\n     * @deprecated\r\n     * @param {string} text\r\n     * @param {{x: number, y: number}} pos\r\n     * @param {string} color\r\n     * @param {string} colorL\r\n     */\r\n    TextNode.prototype.drawSimpleText = function (text, pos, color, colorL) {\r\n        var context = this.layer.context;\r\n        context.fillStyle = color ? color : this.color;\r\n        context.textAlign = this.hAlign;\r\n        context.textBaseline = this.vAlign;\r\n        context.font = this.font;\r\n        context.lineWidth = this.lineWidth;\r\n        context.strokeStyle = colorL ? colorL : this.colorL;\r\n\r\n        var lines = text.split(\"\\n\");\r\n\r\n        pos = pos ? pos : this.pos;\r\n\r\n        if (this.alpha != 1) {\r\n            var tmpAlpha = context.globalAlpha;\r\n            context.globalAlpha = this.alpha;\r\n        }\r\n\r\n        for (var i = 0, len = lines.length; i < len; i += 1) {\r\n            if (this.lineWidth) {\r\n                context.strokeText(lines[i], pos.x, pos.y + this.sizePx * i);\r\n            }\r\n            context.fillText(lines[i], pos.x, pos.y + this.sizePx * i);\r\n        }\r\n\r\n        if (this.alpha != 1) {\r\n            context.globalAlpha = tmpAlpha;\r\n        }\r\n\r\n        context.lineWidth = 0;\r\n        context.strokeStyle = 'black';\r\n    };\r\n\r\n    /**\r\n     * Возвращает текст\r\n     *\r\n     * @returns {string}\r\n     */\r\n    TextNode.prototype.getText = function () {\r\n        return this.fullText;\r\n    };\r\n\r\n    /**\r\n     * Устанавливает текст\r\n     *\r\n     * @param {string} text\r\n     */\r\n    TextNode.prototype.setText = function (text) {\r\n        this.fullText = text;\r\n        this.maxWidth = 0;\r\n        this.lines = text.split(\"\\n\");\r\n\r\n        j2Ds.scene.context.font = this.font;\r\n\r\n        this.box.offset.y = MathUtil.toInt(this.sizePx * 0.26);\r\n        this.box.size.y = -MathUtil.toInt(this.sizePx * 0.26);\r\n\r\n        for (var i = 0, len = this.lines.length; i < len; i += 1) {\r\n            this.maxWidth = (this.maxWidth < j2Ds.scene.context.measureText(this.lines[i]).width ?\r\n                j2Ds.scene.context.measureText(this.lines[i]).width :\r\n                this.maxWidth);\r\n        }\r\n        this.size.x = this.maxWidth;\r\n        this.size.y = this.lines.length * this.sizePx;\r\n    };\r\n\r\n    /**\r\n     * Метод для отрисовки узла\r\n     */\r\n    TextNode.prototype.draw = function () {\r\n        var context = this.layer.context;\r\n        if (this.visible && this.isLookScene()) {\r\n            if (this.alpha != 1) {\r\n                var tmpAlpha = context.globalAlpha;\r\n                context.globalAlpha = this.alpha;\r\n            }\r\n\r\n            if (this.angle) {\r\n                context.save();\r\n                context.translate(this.getPosition().x - j2Ds.scene.view.pos.x, this.getPosition().y - j2Ds.scene.view.pos.y);\r\n                context.rotate(MathUtil.rad(this.angle));\r\n                context.translate(-(this.getPosition().x - j2Ds.scene.view.pos.x), -(this.getPosition().y - j2Ds.scene.view.pos.y));\r\n            }\r\n\r\n            context.fillStyle = this.color;\r\n            context.textAlign = this.hAlign;\r\n            context.textBaseline = this.vAlign;\r\n            context.font = this.font;\r\n            context.lineWidth = this.lineWidth;\r\n            context.strokeStyle = this.colorL;\r\n\r\n            for (var i = 0, len = this.lines.length; i < len; i += 1) {\r\n                if (this.lineWidth) {\r\n                    context.strokeText(this.lines[i], this.pos.x - j2Ds.scene.view.pos.x, this.pos.y + this.sizePx * i - j2Ds.scene.view.pos.y);\r\n                }\r\n                context.fillText(this.lines[i], this.pos.x - j2Ds.scene.view.pos.x, this.pos.y + this.sizePx * i - j2Ds.scene.view.pos.y);\r\n            }\r\n\r\n            context.lineWidth = 0;\r\n            context.strokeStyle = 'black';\r\n\r\n            if (this.angle) {\r\n                context.restore();\r\n            }\r\n\r\n            if (this.alpha != 1) {\r\n                context.globalAlpha = tmpAlpha;\r\n            }\r\n        }\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.TextNode = TextNode;\r\n    if (global.j2Ds !== undefined) global.modules.nodes.TextNode = TextNode;\r\n    return TextNode;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('managers/DeviceManager', [], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        factory();\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function () {\r\n    \"use strict\";\r\n\r\n    var DeviceManager = function () {\r\n        return {\r\n            width: (parseInt(document.documentElement.clientWidth) < parseInt(screen.width))\r\n                ? parseInt(document.documentElement.clientWidth)\r\n                : parseInt(screen.width),\r\n            height: (parseInt(document.documentElement.clientHeight) < parseInt(screen.height))\r\n                ? parseInt(document.documentElement.clientHeight)\r\n                : parseInt(screen.height)\r\n        };\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.DeviceManager = DeviceManager;\r\n    if (global.j2Ds !== undefined) global.modules.managers.DeviceManager = DeviceManager;\r\n    return DeviceManager;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('managers/ErrorManager', [], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        factory();\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function () {\r\n    \"use strict\";\r\n\r\n    var ErrorManager = function (j2Ds) {\r\n        this.j2Ds = j2Ds;\r\n        this.mode = 'neverShow'; // values: onlyShow|stopAndShow|neverShow\r\n        this.enabled = false;\r\n    };\r\n\r\n    ErrorManager.prototype.init = function (_true) {\r\n        var errorManager = this;\r\n        errorManager.enabled = _true || true;\r\n\r\n        var runBtn = document.createElement('div');\r\n        runBtn.innerHTML = '<b>RUN</b>';\r\n        runBtn.style.padding = '5px';\r\n        runBtn.align = 'center';\r\n        runBtn.style.position = 'fixed';\r\n        runBtn.style.zIndex = 20000;\r\n        runBtn.style.left = '0px';\r\n        runBtn.style.top = -20 + errorManager.j2Ds.getDeviceManager().height + 'px';\r\n        runBtn.style.fontSize = '8pt';\r\n        runBtn.style.backgroundColor = '#B8FFB8';\r\n        runBtn.style.height = '12px';\r\n        runBtn.style.width = '50px';\r\n        runBtn.style.cursor = 'pointer';\r\n\r\n        runBtn.onmousedown = function (e) {\r\n            e.stopPropagation();\r\n        };\r\n\r\n        runBtn.onclick = function (e) {\r\n            e.stopPropagation();\r\n            errorManager.show('Выполнение продолжено');\r\n            errorManager.j2Ds.runEngine(errorManager.j2Ds);\r\n            return false;\r\n        };\r\n\r\n        errorManager.j2Ds.dom.attach(runBtn);\r\n        errorManager.logListener.elems.push(runBtn);\r\n\r\n\r\n        var pauseBtn = document.createElement('div');\r\n        pauseBtn.innerHTML = '<b>PAUSE</b>';\r\n        pauseBtn.style.padding = '5px';\r\n        pauseBtn.align = 'center';\r\n        pauseBtn.style.position = 'fixed';\r\n        pauseBtn.style.zIndex = 20000;\r\n        pauseBtn.style.left = '60px';\r\n        pauseBtn.style.top = -20 + errorManager.j2Ds.getDeviceManager().height + 'px';\r\n        pauseBtn.style.fontSize = '8pt';\r\n        pauseBtn.style.backgroundColor = '#FFFFBD';\r\n        pauseBtn.style.height = '12px';\r\n        pauseBtn.style.width = '50px';\r\n        pauseBtn.style.cursor = 'pointer';\r\n\r\n        pauseBtn.onmousedown = function (e) {\r\n            e.stopPropagation();\r\n        };\r\n\r\n        pauseBtn.onclick = function (e) {\r\n            e.stopPropagation();\r\n            errorManager.show('Выполнение приостановлено');\r\n            errorManager.j2Ds.stopEngine();\r\n            return false;\r\n        };\r\n\r\n        errorManager.j2Ds.dom.attach(pauseBtn);\r\n        errorManager.logListener.elems.push(pauseBtn);\r\n\r\n        var reloadBtn = document.createElement('div');\r\n        reloadBtn.innerHTML = '<b>RELOAD</b>';\r\n        reloadBtn.style.padding = '5px';\r\n        reloadBtn.align = 'center';\r\n        reloadBtn.style.position = 'fixed';\r\n        reloadBtn.style.zIndex = 20000;\r\n        reloadBtn.style.left = '120px';\r\n        reloadBtn.style.top = -20 + errorManager.j2Ds.getDeviceManager().height + 'px';\r\n        reloadBtn.style.fontSize = '8pt';\r\n        reloadBtn.style.backgroundColor = '#E2E2E2';\r\n        reloadBtn.style.color = 'black';\r\n        reloadBtn.style.height = '12px';\r\n        reloadBtn.style.width = '50px';\r\n        reloadBtn.style.cursor = 'pointer';\r\n\r\n        reloadBtn.onmousedown = function (e) {\r\n            e.stopPropagation();\r\n        };\r\n\r\n        reloadBtn.onclick = function (e) {\r\n            e.stopPropagation();\r\n            errorManager.j2Ds.dom.reloadURL();\r\n            return false;\r\n        };\r\n\r\n        errorManager.j2Ds.dom.attach(reloadBtn);\r\n        errorManager.logListener.elems.push(reloadBtn);\r\n\r\n        errorManager.j2Ds.events.addEvent('dom:loaded', function () {\r\n            errorManager.j2Ds.window.onerror = function (e) {\r\n                errorManager.show(e);\r\n            };\r\n        });\r\n    };\r\n\r\n    ErrorManager.prototype.show = function (string) {\r\n        console.log('[j2Ds]: ' + string);\r\n    };\r\n\r\n    ErrorManager.prototype.setMode = function (mode) {\r\n        this.mode = mode;\r\n        if (mode == 'neverShow') {\r\n            this.enabled = false;\r\n        }\r\n    };\r\n\r\n    ErrorManager.prototype.debug = function (string) {\r\n        if (!this.enabled) return;\r\n        this.j2Ds.stopEngine();\r\n        if (this.mode != 'neverShow') {\r\n            this.show(string || 'Точка останова достигнута');\r\n        }\r\n    };\r\n\r\n    ErrorManager.prototype.showError = function (err, _func) {\r\n        if (this.mode == 'neverShow') return;\r\n\r\n        var stack = err.stack.toString();\r\n        stack = stack.split(/\\n/);\r\n\r\n        for (var i = 0, len = stack.length; i < len; i += 1) {\r\n            if (stack[i].match(/\\:\\d/)) {\r\n                stack = stack[i].split(/\\s/);\r\n                break;\r\n            }\r\n        }\r\n\r\n        stack = stack[stack.length - 1];\r\n        stack = stack.replace(/([\\(\\)]|[\\w]+:\\/\\/)/g, '');\r\n        var file = stack.split(':'),\r\n            line = file[1],\r\n            number = file[2];\r\n        file = decodeURI(file[0]);\r\n\r\n        if (file.match(/(<anonymous>|\\bj2Ds.js)/)) {\r\n            file = '<Функция-аргумент или строка>';\r\n        }\r\n\r\n        var errMess = 'Тип ошибки: \"' + err.name + '\"' +\r\n            '\\nСообщение: \"' + err.message + '\"' +\r\n            '\\nФайл с ошибкой: \"' + file + '\"' +\r\n            '\\nСтрока: ' + line +\r\n            ', символ: ' + number;\r\n\r\n        if (_func) {\r\n            errMess += '\\nОшибка в теле функции: \\n' + _func.toString();\r\n        }\r\n\r\n        this.show(errMess);\r\n\r\n        if (this.mode == 'stopAndShow') {\r\n            this.j2Ds.stopEngine();\r\n            this.show('Выполнение приостановлено');\r\n        }\r\n\r\n    };\r\n\r\n    ErrorManager.prototype.logListener = {\r\n        domId: '',\r\n        count: 0,\r\n        execLine: '',\r\n        elems: []\r\n    };\r\n\r\n    ErrorManager.prototype.lightSyntax = function (_code, _type) {\r\n        var code = ('' + _code).toString();\r\n\r\n        if (_type == 'boolean') {\r\n            code = code.replace(/true/gi, '<b style=\"color: #12D400;\">$&</b>')\r\n                .replace(/false/gi, '<b style=\"color: #FF4444;\">$&</b>');\r\n        } else if (_type == 'code') {\r\n            code = code.replace(/(this|var|typeof|new|return|if|else|for|in|while|break|do|continue|switch|case)([^a-z0-9\\$_])/gi,\r\n                '<span style=\"color: #FFC0CB;\"><b>$1</b></span>$2')\r\n                .replace(/(function|object)/gi,\r\n                    '<span style=\"color: #FFA500;\">$1</span>')\r\n                .replace(/(width|height|window|document|scene|j2Ds|value)/gi,\r\n                    '<span style=\"color: #59B5C0;\">$1</span>')\r\n                .replace(/([a-z\\_\\$][a-z0-9_]*)\\(/gi, '<span style=\"color: #FFCD70;\">$1</span>(')\r\n                .replace(/(\\{|\\}|\\]|\\[|\\|)/gi, '<span style=\"color: #FFFF00;\">$1</span>')\r\n                .replace(/('.*?')/g, '<span style=\"color: #8FFF8F;\">$1</span>')\r\n                .replace(/(#[a-z0-9]{3,8};)/, '<b style=\"color: red;\">$1</b>')\r\n                .replace(/(\\t)/g, '&nbsp;&nbsp;');\r\n\r\n            code = code.replace(/true/gi, '<b style=\"color: #12D400;\">$&</b>')\r\n                .replace(/false/gi, '<b style=\"color: #FF4444;\">$&</b>');\r\n        }\r\n\r\n        return code;\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.ErrorManager = ErrorManager;\r\n    if (global.j2Ds !== undefined) global.modules.managers.ErrorManager = ErrorManager;\r\n    return ErrorManager;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('managers/FpsManager', [], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        factory();\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function () {\r\n    \"use strict\";\r\n\r\n    var FpsManager = function (j2Ds) {\r\n        this.j2Ds = j2Ds;\r\n\r\n        this.enabled = false;\r\n        this.fps = this.j2Ds.frameLimit;\r\n        this.tmp_of_fps = 1;\r\n        this.tmp_of_time = Date.now();\r\n    };\r\n\r\n    FpsManager.prototype.init = function () {\r\n        var fpsManager = this;\r\n        fpsManager.enabled = true;\r\n\r\n        this.j2Ds.events.addEvent('engine:after', function () {\r\n            fpsManager.update();\r\n        });\r\n    };\r\n\r\n    FpsManager.prototype.update = function () {\r\n        if (!this.enabled) return;\r\n        this.tmp_of_fps += 1;\r\n        if (this.j2Ds.now - this.tmp_of_time >= 1000) {\r\n            this.fps = this.tmp_of_fps;\r\n            this.tmp_of_fps = 1;\r\n            this.tmp_of_time = this.j2Ds.now;\r\n        }\r\n    };\r\n\r\n    FpsManager.prototype.getFPS = function () {\r\n        return this.fps <= this.j2Ds.frameLimit ? this.fps : this.j2Ds.frameLimit;\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.FpsManager = FpsManager;\r\n    if (global.j2Ds !== undefined) global.modules.managers.FpsManager = FpsManager;\r\n    return FpsManager;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('managers/ResourceManager', [], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        factory();\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function () {\r\n    \"use strict\";\r\n\r\n    var ResourceManager = function (j2Ds) {\r\n        this.j2Ds = j2Ds;\r\n\r\n        this.added = 0;\r\n        this.loaded = 0;\r\n        this.failed = 0;\r\n\r\n        this.add = function () {\r\n            this.added += 1;\r\n        };\r\n\r\n        this.ok = function (file) {\r\n            this.loaded += 1;\r\n            this.j2Ds.errorManager.show('loaded: \"' + decodeURI(file));\r\n        };\r\n\r\n        this.fail = function (file) {\r\n            this.failed += 1;\r\n            this.j2Ds.errorManager.show('error load: \"' + decodeURI(file));\r\n        };\r\n\r\n        this.show = function () {\r\n            return {'added': this.added, 'loaded': this.loaded, 'failed': this.failed};\r\n        };\r\n\r\n        this.isLoaded = function () {\r\n            return this.added == this.loaded;\r\n        };\r\n\r\n        this.getProgress = function () {\r\n            return Math.ceil(this.loaded / this.added * 100);\r\n        };\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.ResourceManager = ResourceManager;\r\n    if (global.j2Ds !== undefined) global.modules.managers.ResourceManager = ResourceManager;\r\n    return ResourceManager;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('managers/StorageManager', [], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        factory();\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function () {\r\n    \"use strict\";\r\n\r\n    var StorageManager = function (j2Ds, id) {\r\n        this.j2Ds = j2Ds;\r\n        this.id = id;\r\n        this.ls = this.j2Ds.window.localStorage ? this.j2Ds.window.localStorage : false;\r\n        if (!this.ls) alert('j2Ds ERROR in \"createLocal(' + id + ')\" \\n' + 'Объект \"localStorage\" не поддерживается.');\r\n    };\r\n\r\n    StorageManager.prototype.saveNode = function (name, o) {\r\n        if (!this.ls) return false;\r\n        this.ls.setItem(this.id + name, JSON.stringify(o));\r\n    };\r\n\r\n    StorageManager.prototype.load = function (name) {\r\n        if (!this.ls) {\r\n            return false;\r\n        }\r\n        return this.ls.getItem(this.id + name);\r\n    };\r\n\r\n    StorageManager.prototype.is = function (name) {\r\n        if (!this.ls) {\r\n            return false;\r\n        }\r\n        return !!(this.ls.getItem(this.id + name));\r\n    };\r\n\r\n    StorageManager.prototype.save = function (name, value) {\r\n        if (!this.ls) {\r\n            return false;\r\n        }\r\n        this.ls.setItem(this.id + name, value);\r\n    };\r\n\r\n    StorageManager.prototype.loadNode = function (name) {\r\n        if (!this.ls) {\r\n            return false;\r\n        }\r\n        return JSON.parse(this.ls.getItem(this.id + name));\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.StorageManager = StorageManager;\r\n    if (global.j2Ds !== undefined) global.modules.managers.StorageManager = StorageManager;\r\n    return StorageManager;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('managers/TimeManager', [], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        factory();\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function () {\r\n    \"use strict\";\r\n\r\n    var TimeManager = function (j2Ds) {\r\n        this.j2Ds = j2Ds;\r\n        this.times = {};\r\n\r\n        this.insert = function (id) {\r\n            if (!this.times[id]) {\r\n                this.times[id] = this.j2Ds.now;\r\n            }\r\n        };\r\n\r\n        this.get = function (id) {\r\n            return this.times[id];\r\n        };\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.TimeManager = TimeManager;\r\n    if (global.j2Ds !== undefined) global.modules.managers.TimeManager = TimeManager;\r\n    return TimeManager;\r\n}));\r\n\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('managers/TriggerManager', [], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        factory();\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function () {\r\n    \"use strict\";\r\n\r\n    var TriggerManager = function (j2Ds) {\r\n        this.j2Ds = j2Ds;\r\n        this.enabled = false;\r\n        this.triggers = {};\r\n    };\r\n\r\n    TriggerManager.prototype.add = function (id, callback) {\r\n        var triggerManager = this;\r\n        var trigger = {\r\n            command: callback,\r\n            count: 0,\r\n            state: 'stop',\r\n            last: false\r\n        };\r\n\r\n        trigger.run = function (mSec) {\r\n            if (this.state == 'job') {\r\n                this.command();\r\n                return;\r\n            }\r\n            if (triggerManager.j2Ds.now - this.last > mSec) {\r\n                if (this.last) {\r\n                    this.state = 'job';\r\n                    this.count += 1;\r\n                    this.command();\r\n                }\r\n                this.last = triggerManager.j2Ds.now;\r\n            }\r\n        };\r\n\r\n        trigger.job = function (mSec) {\r\n            if (triggerManager.j2Ds.now - this.last > mSec && this.state != 'run') {\r\n                if (this.last) {\r\n                    this.state = 'run';\r\n                    this.count += 1;\r\n                    this.command();\r\n                }\r\n                this.last = triggerManager.j2Ds.now;\r\n            }\r\n        };\r\n\r\n        trigger.loop = function (mSec) {\r\n            if (triggerManager.j2Ds.now - this.last > mSec) {\r\n                if (this.last) {\r\n                    this.state = 'run';\r\n                    this.count += 1;\r\n                    this.command();\r\n                }\r\n                this.last = triggerManager.j2Ds.now;\r\n            }\r\n        };\r\n\r\n        trigger.reset = function () {\r\n            this.count = 0;\r\n            this.state = 'stop';\r\n            this.last = false;\r\n        };\r\n\r\n        this.triggers[id] = trigger;\r\n        return trigger;\r\n    };\r\n\r\n    TriggerManager.prototype.get = function (id) {\r\n        return this.triggers[id];\r\n    };\r\n\r\n    TriggerManager.prototype.init = function () {\r\n        this.enabled = true;\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.TriggerManager = TriggerManager;\r\n    if (global.j2Ds !== undefined) global.modules.managers.TriggerManager = TriggerManager;\r\n    return TriggerManager;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('managers/ViewManager', ['utils/MathUtil'], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory(require('utils/MathUtil'));\r\n    } else {\r\n        factory(root.modules.utils.MathUtil);\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function (MathUtil) {\r\n    \"use strict\";\r\n\r\n    var ViewManager = function (j2Ds) {\r\n        this.j2Ds = j2Ds;\r\n        this.views = {};\r\n    };\r\n\r\n    ViewManager.prototype.add = function (id, pos) {\r\n        var viewManager = this;\r\n        var viewport = {\r\n            focusNode: false\r\n        };\r\n\r\n        viewport.pos = pos ? MathUtil.v2f(pos.x, pos.y) : MathUtil.v2f(0, 0);\r\n\r\n        viewport.setPosition = function (pos) {\r\n            if (!pos) return this;\r\n            this.pos = MathUtil.v2f(pos.x - viewManager.j2Ds.scene.width / 2, pos.y - viewManager.j2Ds.scene.height / 2);\r\n        };\r\n\r\n        viewport.getPosition = function () {\r\n            return this.pos;\r\n        };\r\n\r\n        viewport.move = function (pos) {\r\n            this.pos.x += pos.x;\r\n            this.pos.y += pos.y;\r\n        };\r\n\r\n        viewManager.j2Ds.viewManager.views[id] = viewport;\r\n        return viewport;\r\n    };\r\n\r\n    ViewManager.prototype.get = function (id) {\r\n        return this.j2Ds.viewManager.views[id];\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.ViewManager = ViewManager;\r\n    if (global.j2Ds !== undefined) global.modules.managers.ViewManager = ViewManager;\r\n    return ViewManager;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('io/AudioHandler', [], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        factory();\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function () {\r\n    \"use strict\";\r\n\r\n    var AudioHandler = function () {\r\n        this.audios = {};\r\n        this.enabled = false\r\n    };\r\n\r\n    AudioHandler.prototype.init = function () {\r\n        var audioHandler = this;\r\n        this.enabled = true;\r\n\r\n        audioHandler.j2Ds.events.addEvent('scene:deactivate', function () {\r\n            audioHandler.deactivate();\r\n        });\r\n\r\n        audioHandler.j2Ds.events.addEvent('scene:activate', function () {\r\n            audioHandler.activate();\r\n        });\r\n\r\n    };\r\n\r\n    AudioHandler.prototype.load = function (id, files, vol) {\r\n        var audioHandler = this;\r\n        audioHandler.j2Ds.resources.add();\r\n        var audio = document.createElement('audio');\r\n\r\n        for (var i = 0, len = files.length; i < len; i += 1) {\r\n            var source = document.createElement('source');\r\n            source.src = files[i];\r\n            audio.appendChild(source);\r\n        }\r\n\r\n        audio.id = 'audio_' + id;\r\n\r\n        if (vol) {\r\n            audio.volume = (vol <= 1 && vol >= 0) ? vol : 1;\r\n        }\r\n\r\n        var sound = {\r\n            id: id,\r\n            files: files,\r\n            domEl: audio, // DOMElement\r\n            ready: false,\r\n            len: 0,\r\n            state: 'stop',\r\n            lock: false,\r\n            volume: audio.volume,\r\n            onePlay: false\r\n        };\r\n\r\n        sound.domEl.addEventListener('loadeddata', function (e) {\r\n            sound.ready = true;\r\n            var file = e.explicitOriginalTarget || e.path[0];\r\n            audioHandler.j2Ds.resources.ok(file.currentSrc);\r\n        });\r\n\r\n        sound.domEl.addEventListener('error', function (e) {\r\n            sound.setLock(true);\r\n            //var file = e.srcElement || e.target;\r\n            //audioHandler.j2Ds.resources.fail(file.src);\r\n        });\r\n\r\n        sound.domEl.addEventListener('ended', function () {\r\n            sound.state = 'stop';\r\n        });\r\n\r\n        sound.play = function (unlock) {\r\n            if (unlock) {\r\n                this.setLock(false);\r\n            }\r\n            if (this.lock) return;\r\n            if (this.state == 'play') {\r\n                this.domEl.currentTime = 0;\r\n            }\r\n            this.domEl.play();\r\n            this.state = 'play';\r\n        };\r\n\r\n        sound.loop = function () {\r\n            if (this.lock) return;\r\n            this.domEl.play();\r\n            this.state = 'play';\r\n        };\r\n\r\n        sound.pause = function (lock) {\r\n            if (this.state == 'play') {\r\n                this.setLock(lock);\r\n                this.domEl.pause();\r\n                this.state = 'pause';\r\n            }\r\n        };\r\n\r\n        sound.stop = function (lock) {\r\n            this.domEl.pause();\r\n            this.domEl.currentTime = 0;\r\n            this.state = 'stop';\r\n            if (lock) {\r\n                this.setLock(lock);\r\n            }\r\n        };\r\n\r\n        sound.setLock = function (lock) {\r\n            this.lock = lock ? true : false;\r\n        };\r\n\r\n        sound.setVolume = function (vol) {\r\n            this.domEl.volume = (vol <= 1 && vol >= 0) ? vol : 1;\r\n            this.volume = this.domEl.volume;\r\n        };\r\n\r\n        sound.getVolume = function (id) {\r\n            return this.volume;\r\n        };\r\n\r\n        sound.getState = function (id) {\r\n            return this.state;\r\n        };\r\n\r\n        sound.getPlayPosition = function () {\r\n            return this.domEl.currentTime;\r\n        };\r\n\r\n        sound.domEl.load();\r\n\r\n        this.audios[id] = sound;\r\n        return sound;\r\n    };\r\n\r\n    AudioHandler.prototype.get = function (id) {\r\n        return this.audios[id];\r\n    };\r\n\r\n    AudioHandler.prototype.pause = function (lock) {\r\n        for (var snd in this.audios) {\r\n            this.audios[snd].pause(lock);\r\n        }\r\n    };\r\n\r\n    AudioHandler.prototype.stop = function (lock) {\r\n        for (var snd in this.audios) {\r\n            this.audios[snd].stop(lock);\r\n        }\r\n    };\r\n\r\n    AudioHandler.prototype.play = function (unlock) {\r\n        for (var snd in this.audios) {\r\n            this.audios[snd].play(unlock);\r\n        }\r\n    };\r\n\r\n    AudioHandler.prototype.deactivate = function () {\r\n        for (var snd in this.audios) {\r\n            if (this.audios[snd].state == 'play') {\r\n                this.audios[snd].pause();\r\n                this.audios[snd].state = 'deactivated';\r\n            }\r\n        }\r\n    };\r\n\r\n    AudioHandler.prototype.activate = function () {\r\n        for (var snd in this.audios) {\r\n            if (this.audios[snd].state == 'deactivated') {\r\n                this.audios[snd].play();\r\n            }\r\n        }\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.AudioHandler = AudioHandler;\r\n    if (global.j2Ds !== undefined) global.modules.io.AudioHandler = AudioHandler;\r\n    return AudioHandler;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.5\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('io/InputHandler', ['utils/MathUtil', 'nodes/BaseNode'], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory(require('utils/MathUtil'), require('nodes/BaseNode'));\r\n    } else {\r\n        factory(root.modules.utils.MathUtil, root.modules.nodes.BaseNode);\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function (MathUtil, BaseNode) {\r\n    \"use strict\";\r\n\r\n    var InputHandler = function (j2Ds) {\r\n        this.j2Ds = j2Ds;\r\n\r\n        this.pos = {x: 0, y: 0};\r\n        this.x = 0;\r\n        this.y = 0;\r\n        this.screenPos = {x: 0, y: 0};\r\n        this.touch = false;\r\n        this.touchTap = false;\r\n        this.touchHold = false;\r\n        this.touchAutoHold = false;\r\n        this.touchCount = 0;\r\n        this.touchDuration = 60;\r\n        this.keyDown = [];\r\n        this.keyPress = [];\r\n        this.keyPressed = [];\r\n        this.keyUp = [];\r\n        this.keyUped = false;\r\n        this.mouseDown = [];\r\n        this.mousePress = [];\r\n        this.mousePressed = [];\r\n        this.mouseUp = [];\r\n        this.mouseUpped = false;\r\n        this.mouseWheel = 0;\r\n        this.canceled = false;\r\n        this.body = false;\r\n        this.anyKey = false;\r\n        this.anyMouse = false;\r\n        this.writeMode = false;\r\n        this.displayCursor = '';\r\n        this.visible = true;\r\n        this.enabled = false;\r\n    };\r\n\r\n    InputHandler.prototype.mKey = {\r\n        'LEFT': 1,\r\n        'MIDDLE': 2,\r\n        'RIGHT': 3\r\n    };\r\n\r\n    InputHandler.prototype.jKey = {\r\n        'LEFT': 37,\r\n        'RIGHT': 39,\r\n        'UP': 38,\r\n        'DOWN': 40,\r\n        'SPACE': 32,\r\n        'CTRL': 17,\r\n        'SHIFT': 16,\r\n        'ALT': 18,\r\n        'ESC': 27,\r\n        'ENTER': 13,\r\n        'MINUS': 189,\r\n        'PLUS': 187,\r\n        'CAPS_LOCK': 20,\r\n        'BACKSPACE': 8,\r\n        'TAB': 9,\r\n        'Q': 81,\r\n        'W': 87,\r\n        'E': 69,\r\n        'R': 82,\r\n        'T': 84,\r\n        'Y': 89,\r\n        'U': 85,\r\n        'I': 73,\r\n        'O': 79,\r\n        'P': 80,\r\n        'A': 65,\r\n        'S': 83,\r\n        'D': 68,\r\n        'F': 70,\r\n        'G': 71,\r\n        'H': 72,\r\n        'J': 74,\r\n        'K': 75,\r\n        'L': 76,\r\n        'Z': 90,\r\n        'X': 88,\r\n        'V': 86,\r\n        'B': 66,\r\n        'N': 78,\r\n        'M': 77,\r\n        '0': 48,\r\n        '1': 49,\r\n        '2': 50,\r\n        '3': 51,\r\n        '4': 52,\r\n        '5': 53,\r\n        '6': 54,\r\n        '7': 55,\r\n        '8': 56,\r\n        'C': 67,\r\n        '9': 57,\r\n        'NUM_0': 45,\r\n        'NUM_1': 35,\r\n        'NUM_2': 40,\r\n        'NUM_3': 34,\r\n        'NUM_4': 37,\r\n        'NUM_5': 12,\r\n        'NUM_6': 39,\r\n        'NUM_7': 36,\r\n        'NUM_8': 38,\r\n        'NUM_9': 33,\r\n        'NUM_MINUS': 109,\r\n        'NUM_PLUS': 107,\r\n        'NUM_LOCK': 144,\r\n        'F1': 112,\r\n        'F2': 113,\r\n        'F3': 114,\r\n        'F4': 115,\r\n        'F5': 116,\r\n        'F6': 117,\r\n        'F7': 118,\r\n        'F8': 119,\r\n        'F9': 120,\r\n        'F10': 121,\r\n        'F11': 122,\r\n        'F12': 123\r\n    };\r\n\r\n    InputHandler.prototype.keyList = function () {\r\n        var o = [];\r\n        for (var i in this.jKey) {\r\n            o.push(i);\r\n        }\r\n        return o;\r\n    };\r\n\r\n    InputHandler.prototype.reset = function () {\r\n        if (!this.enabled) return false;\r\n        this.keyPress = [];\r\n        this.keyUp = [];\r\n        this.mousePress = [];\r\n        this.mouseUp = [];\r\n        this.mouseWheel = 0;\r\n        this.touchHold = false;\r\n        this.touchTap = false;\r\n    };\r\n\r\n    InputHandler.prototype.isKeyDown = function (code) {\r\n        return this.keyDown[this.jKey[code]] !== undefined;\r\n    };\r\n\r\n    InputHandler.prototype.isKeyPress = function (code) {\r\n        return this.keyPress[this.jKey[code]] !== undefined;\r\n    };\r\n\r\n    InputHandler.prototype.isKeyUp = function (code) {\r\n        return this.keyUp[this.jKey[code]] !== undefined;\r\n    };\r\n\r\n    InputHandler.prototype.getPosition = function () {\r\n        return MathUtil.v2f(this.pos.x, this.pos.y);\r\n    };\r\n\r\n    InputHandler.prototype.getScreenPosition = function () {\r\n        return MathUtil.v2f(this.screenPos.x, this.screenPos.y);\r\n    };\r\n\r\n    InputHandler.prototype.setWriteMode = function (_true) {\r\n        this.writeMode = _true;\r\n    };\r\n\r\n    InputHandler.prototype.isWriteMode = function () {\r\n        return this.writeMode;\r\n    };\r\n\r\n    InputHandler.prototype.keyEvent = function (e) {\r\n        if (!this.enabled) return false;\r\n        if (e.type === 'keydown') {\r\n            if (!this.keyPressed[e.keyCode]) {\r\n                this.keyPress[e.keyCode] = true;\r\n                this.keyPressed[e.keyCode] = true;\r\n            }\r\n            if (!this.writeMode) {\r\n                e.preventDefault();\r\n            } else {\r\n                this.j2Ds.events.onEvent('writeMode:keyPress', '');\r\n            }\r\n        } else if (e.type === 'keyup') {\r\n            if (this.keyPressed[e.keyCode]) {\r\n                e.preventDefault();\r\n                this.keyPress[e.keyCode] = false;\r\n                this.keyPressed[e.keyCode] = false;\r\n                this.keyUp[e.keyCode] = true;\r\n                this.keyUped = true;\r\n            }\r\n        } else if (e.type === 'keypress' && (this.writeMode)) {\r\n            var char = '';\r\n            if (e.which !== 0 && e.charCode !== 0) {\r\n                if (e.which >= 32) {\r\n                    char = String.fromCharCode(e.which);\r\n                }\r\n            }\r\n            this.j2Ds.events.onEvent('writeMode:keyPress', char);\r\n        }\r\n\r\n        this.keyDown[e.keyCode] = (e.type === 'keydown') && (!this.canceled);\r\n        this.anyKey = e.keyCode;\r\n        return false;\r\n    };\r\n\r\n    InputHandler.prototype.cancel = function (id) {\r\n        if (!id) {\r\n            this.canceled = true;\r\n            this.keyDown = [];\r\n            this.mouseDown = [];\r\n            this.touchHold = false;\r\n            this.touchTap = false;\r\n            this.touch = false;\r\n            this.touchCount = 0;\r\n        } else {\r\n            this.keyDown[this.jKey[id]] = false;\r\n        }\r\n    };\r\n\r\n    InputHandler.prototype.onNode = function (node) {\r\n        if (node instanceof BaseNode) {\r\n            if (!node.layer.visible || !node.isLookScene()) return false;\r\n            return node.isPointInsideBox(node.getBoxVertices(), this.pos);\r\n        } else if (node instanceof Array && node.length > 0 && node[0] instanceof BaseNode) {\r\n            for (var i = 0; i < node.length; i++) {\r\n                if (!node[i].layer.visible || !node[i].isLookScene()) continue;\r\n                if (node[i].isPointInsideBox(node[i].getBoxVertices(), this.pos)) return true;\r\n            }\r\n            return false;\r\n        }\r\n    };\r\n\r\n    InputHandler.prototype.upd = function () {\r\n        if (!this.enabled) return false;\r\n        var dX = this.j2Ds.scene.offsetWidth / this.j2Ds.scene.width;\r\n        var dY = this.j2Ds.scene.offsetHeight / this.j2Ds.scene.height;\r\n        this.x = (this.screenPos.x / dX);\r\n        this.y = (this.screenPos.y / dY);\r\n        this.pos.x = this.j2Ds.scene.view.pos.x + this.x;\r\n        this.pos.y = this.j2Ds.scene.view.pos.y + this.y;\r\n\r\n        if (this.touchCount > 0 && this.touchCount < this.touchDuration) this.touchCount++;\r\n        // Repeater TouchHold\r\n        if (!this.touchHold && this.touchCount >= this.touchDuration) {\r\n            if (this.touchAutoHold) this.touchHold = true;\r\n        }\r\n    };\r\n\r\n    InputHandler.prototype.onMove = function (e) {\r\n        var input = this.j2Ds.input;\r\n        if (!input.touch) {\r\n            input.screenPos.x = -input.j2Ds.scene.offsetLeft + e.pageX;\r\n            input.screenPos.y = -input.j2Ds.scene.offsetTop + e.pageY;\r\n        }\r\n    };\r\n\r\n    InputHandler.prototype.isMouseDown = function (code) {\r\n        return this.mouseDown[this.mKey[code]];\r\n    };\r\n\r\n    InputHandler.prototype.isMousePress = function (code) {\r\n        return this.mousePress[this.mKey[code]];\r\n    };\r\n\r\n    InputHandler.prototype.isMouseUp = function (code) {\r\n        return this.mouseUp[this.mKey[code]];\r\n    };\r\n\r\n    InputHandler.prototype.isTouch = function () {\r\n        return this.touch;\r\n    };\r\n\r\n    InputHandler.prototype.isTouchTap = function () {\r\n        return this.touchTap;\r\n    };\r\n\r\n    InputHandler.prototype.isTouchHold = function () {\r\n        return this.touchHold;\r\n    };\r\n\r\n    InputHandler.prototype.setTouchDuration = function (duration) {\r\n        return this.touchDuration = (duration > 0) ? duration : 60;\r\n    };\r\n\r\n    InputHandler.prototype.isMouseWheel = function (code) {\r\n        return (code === 'UP' && this.mouseWheel > 0) ||\r\n            (code === 'DOWN' && this.mouseWheel < 0)\r\n    };\r\n\r\n    InputHandler.prototype.onMouseWheel = function (e) {\r\n        if (!this.enabled) return false;\r\n        e.preventDefault();\r\n        this.mouseWheel = ((e.wheelDelta) ? e.wheelDelta : -e.detail);\r\n        return false;\r\n    };\r\n\r\n    InputHandler.prototype.onMouseEvent = function (e) {\r\n        if (!this.enabled) return false;\r\n        e.preventDefault();\r\n        if (!e.which && e.button) {\r\n            if (e.button & 1) e.which = 1;\r\n            else if (e.button & 4) e.which = 2;\r\n            else if (e.button & 2) e.which = 3;\r\n        }\r\n\r\n        if (e.type === 'mousedown') {\r\n            if (!this.mousePressed[e.which]) {\r\n                this.mousePress[e.which] = true;\r\n                this.mousePressed[e.which] = true;\r\n            }\r\n        } else if (e.type === 'mouseup') {\r\n            if (this.mousePressed[e.which]) {\r\n                this.mousePress[e.which] = false;\r\n                this.mousePressed[e.which] = false;\r\n                this.mouseUp[e.which] = true;\r\n                this.mouseUped = true;\r\n            }\r\n        }\r\n\r\n        this.mouseDown[e.which] = (e.type === 'mousedown') && (!this.canceled);\r\n\r\n        this.j2Ds.window.focus();\r\n        return false;\r\n    };\r\n\r\n    InputHandler.prototype.onTouchEvent = function (e) {\r\n        var input = this.j2Ds.input;\r\n        if (!input.enabled) return false;\r\n        e.preventDefault();\r\n\r\n        if (input.touchCount === 0) input.touchCount++;\r\n\r\n        if (!input.canceled) {\r\n            input.mouseDown = [];\r\n            input.touch = !input.canceled;\r\n        }\r\n\r\n        input.screenPos.x = -input.j2Ds.scene.offsetLeft + e.touches[0].pageX;\r\n        input.screenPos.y = -input.j2Ds.scene.offsetTop + e.touches[0].pageY;\r\n\r\n        input.j2Ds.window.focus();\r\n        return false;\r\n    };\r\n\r\n    InputHandler.prototype.setCursorImage = function (curImg) {\r\n        this.j2Ds.dom.tag('body')[0].style.cursor = 'url(\"' + curImg + '\"), auto';\r\n    };\r\n\r\n    InputHandler.prototype.setVisible = function (_true) {\r\n        this.visible = _true;\r\n        if (!_true) {\r\n            this.displayCursor = this.j2Ds.dom.tag('body')[0].style.cursor;\r\n            this.j2Ds.dom.tag('body')[0].style.cursor = 'none';\r\n        } else {\r\n            this.j2Ds.dom.tag('body')[0].style.cursor = this.displayCursor;\r\n        }\r\n    };\r\n\r\n    InputHandler.prototype.isVisible = function () {\r\n        return this.visible;\r\n    };\r\n\r\n    InputHandler.prototype.init = function () {\r\n        var input = this;\r\n        input.enabled = true;\r\n\r\n        input.j2Ds.events.addEvent('engine:before', function () {\r\n            input.upd();\r\n        });\r\n\r\n        input.j2Ds.events.addEvent('engine:after', function () {\r\n            input.cancel();\r\n        });\r\n\r\n        input.j2Ds.events.addEvent('dom:loaded', function () {\r\n            input.j2Ds.window.focus();\r\n            input.j2Ds.window.addEventListener('touchstart', input.onTouchEvent);\r\n            input.j2Ds.window.addEventListener('touchmove', input.onTouchEvent);\r\n            input.j2Ds.window.addEventListener('touchend', function () {\r\n                input.canceled = false;\r\n                if (input.touchCount >= input.touchDuration) {\r\n                    input.touchHold = true;\r\n                    input.touchTap = false;\r\n                    input.touchCount = 0;\r\n                } else if (input.touchCount >= 0 && input.touchCount < input.touchDuration) {\r\n                    input.touchTap = true;\r\n                    input.touchHold = false;\r\n                    input.touchCount = 0;\r\n                }\r\n                input.touch = false;\r\n            });\r\n            input.j2Ds.window.addEventListener('touchcancel', function () {\r\n                input.canceled = false;\r\n            });\r\n            input.j2Ds.window.oncontextmenu = function () {\r\n                return false;\r\n            };\r\n            input.j2Ds.window.onselectstart = input.j2Ds.window.oncontextmenu;\r\n            input.j2Ds.window.ondragstart = input.j2Ds.window.oncontextmenu;\r\n            input.j2Ds.window.onmousedown = input.onMouseEvent;\r\n            input.j2Ds.window.onmouseup = function (e) {\r\n                input.canceled = false;\r\n                input.onMouseEvent(e);\r\n            };\r\n            input.j2Ds.window.onmousemove = input.onMove;\r\n            input.j2Ds.window.onkeydown = input.keyEvent;\r\n            input.j2Ds.window.onkeyup = function (e) {\r\n                input.canceled = false;\r\n                input.keyEvent(e);\r\n            };\r\n            input.j2Ds.window.onkeypress = input.keyEvent;\r\n            input.j2Ds.window.onmousewheel = input.onMouseWheel;\r\n\r\n            if (input.j2Ds.window.addEventListener) {\r\n                input.j2Ds.window.addEventListener(\"DOMMouseScroll\", input.onMouseWheel, false);\r\n            }\r\n        });\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.InputHandler = InputHandler;\r\n    if (global.j2Ds !== undefined) global.modules.io.InputHandler = InputHandler;\r\n    return InputHandler;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('core/Layers', [], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        factory();\r\n    }\r\n}(typeof window !== 'undefined' ? window : global, function () {\r\n    \"use strict\";\r\n\r\n    var Layers = function (j2Ds) {\r\n        this.j2Ds = j2Ds;\r\n        this.layersList = {};\r\n    };\r\n\r\n    Layers.prototype.layer = function (id) {\r\n        return this.layersList[id];\r\n    };\r\n\r\n    Layers.prototype.add = function (id, index, notDOM) {\r\n        if (!!this.layersList[id]) return false;\r\n\r\n        var layer = {\r\n            layerName: id\r\n        };\r\n\r\n        if (!notDOM) {\r\n            layer.canvas = document.createElement('canvas');\r\n        } else {\r\n            layer.canvas = this.j2Ds.dom.id(id);\r\n        }\r\n\r\n        layer.canvas.style.position = this.j2Ds.scene.stylePosition;\r\n\r\n        layer.canvas.id = id;\r\n\r\n        layer.canvas.style.zIndex = 1000 + index;\r\n        layer.canvas.style.left = this.j2Ds.scene.offsetLeft + 'px';\r\n        layer.canvas.style.top = this.j2Ds.scene.offsetTop + 'px';\r\n\r\n        layer.canvas.width = this.j2Ds.scene.width;\r\n        layer.canvas.height = this.j2Ds.scene.height;\r\n        layer.width = this.j2Ds.scene.width;\r\n        layer.height = this.j2Ds.scene.height;\r\n        layer.context = layer.canvas.getContext('2d');\r\n        layer.context.shadowColor = 'rgba(0,0,0,0)';\r\n        layer.alpha = 1;\r\n        layer.angle = 0;\r\n        layer.visible = 1;\r\n\r\n        layer.onContext = function (callback) {\r\n            callback(this.context);\r\n        };\r\n\r\n        layer.fill = function (color) {\r\n            this.context.fillStyle = color;\r\n            this.context.fillRect(0, 0, this.width, this.height);\r\n        };\r\n\r\n        layer.setAlpha = function (alpha) {\r\n            this.canvas.style.opacity = alpha;\r\n            this.alpha = alpha;\r\n        };\r\n\r\n        layer.getAlpha = function () {\r\n            return this.alpha;\r\n        };\r\n\r\n        layer.setVisible = function (visible) {\r\n            if (visible) {\r\n                this.canvas.style.display = 'block';\r\n                this.visible = true;\r\n            } else {\r\n                this.canvas.style.display = 'none';\r\n                this.visible = false;\r\n            }\r\n        };\r\n\r\n        layer.isVisible = function () {\r\n            return this.visible;\r\n        };\r\n\r\n        layer.setIndex = function (index) {\r\n            this.canvas.style.zIndex = 1000 + index;\r\n        };\r\n\r\n        layer.clear = function () {\r\n            this.context.clearRect(0, 0, this.width, this.height);\r\n        };\r\n\r\n        layer.clearNode = function (node) {\r\n            var layer = this;\r\n            if (node.isLookScene()) {\r\n                this.context.clearRect(\r\n                    node.pos.x - layer.j2Ds.scene.view.pos.x,\r\n                    node.pos.y - layer.j2Ds.scene.view.pos.y,\r\n                    node.size.x,\r\n                    node.size.y\r\n                );\r\n            }\r\n        };\r\n\r\n        layer.setContextSettings = function (settings) {\r\n            for (var i in settings) {\r\n                if (typeof this.context[i] !== 'undefined') {\r\n                    this.context[i] = settings[i];\r\n                }\r\n            }\r\n        };\r\n\r\n        layer.clearRect = function (pos, size) {\r\n            var layer = this;\r\n            this.context.clearRect(pos.x - layer.j2Ds.scene.view.pos.x, pos.y - layer.j2Ds.scene.view.pos.y, size.x, size.y);\r\n        };\r\n\r\n        this.layersList[id] = layer;\r\n\r\n        if (!notDOM) {\r\n            this.j2Ds.dom.attach(this.layersList[id].canvas);\r\n        }\r\n\r\n        return layer;\r\n    };\r\n\r\n    if (typeof module === 'object' && typeof module.exports === 'object') module.exports.Layers = Layers;\r\n    if (global.j2Ds !== undefined) global.modules.core.Layers = Layers;\r\n    return Layers;\r\n}));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.2\r\n */\r\n\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('core/Scene', [\r\n            'nodes/BaseNode',\r\n            'nodes/CircleNode',\r\n            'nodes/LineNode',\r\n            'nodes/RectNode',\r\n            'nodes/SpriteNode',\r\n            'nodes/TextNode',\r\n            'utils/TextureUtil'\r\n        ], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory(\r\n            require('nodes/BaseNode'),\r\n            require('nodes/CircleNode'),\r\n            require('nodes/LineNode'),\r\n            require('nodes/RectNode'),\r\n            require('nodes/SpriteNode'),\r\n            require('nodes/TextNode'),\r\n            require('utils/TextureUtil')\r\n        );\r\n    } else {\r\n        factory(\r\n            root.modules.nodes.BaseNode,\r\n            root.modules.nodes.CircleNode,\r\n            root.modules.nodes.LineNode,\r\n            root.modules.nodes.RectNode,\r\n            root.modules.nodes.SpriteNode,\r\n            root.modules.nodes.TextNode,\r\n            root.modules.utils.TextureUtil\r\n        );\r\n    }\r\n}(typeof window !== 'undefined' ? window : global,\r\n    function (BaseNode,\r\n              CircleNode,\r\n              LineNode,\r\n              RectNode,\r\n              SpriteNode,\r\n              TextNode,\r\n              TextureUtil) {\r\n        \"use strict\";\r\n\r\n        var Scene = function (j2Ds) {\r\n            j2Ds = this.j2Ds = j2Ds;\r\n\r\n            this.nodes = [];\r\n            this.layerName = 'sceneNode';\r\n            this.stylePosition = 'fixed';\r\n            this.layers = j2Ds.layers;\r\n            this.view = false;\r\n            this.gameStateName = false;\r\n            this.canFullScreen = true;\r\n\r\n            this.texture = new TextureUtil(this.j2Ds);\r\n        };\r\n\r\n        /*функции*/\r\n\r\n        Scene.prototype.setView = function (id) {\r\n            this.view = this.j2Ds.viewManager.views[id];\r\n        };\r\n\r\n        Scene.prototype.getView = function () {\r\n            return this.view;\r\n        };\r\n\r\n        Scene.prototype.setAutoDraw = function (toggle) {\r\n            var scene = this;\r\n            if (toggle) {\r\n                scene.j2Ds.events.addEvent('engine:after', function () {\r\n                    scene.drawAllNodes();\r\n                }, 'autoDraw');\r\n            } else {\r\n                scene.j2Ds.events.destroyEvent('engine:after', 'autoDraw');\r\n            }\r\n        };\r\n\r\n        Scene.prototype.setAutoClear = function (toggle) {\r\n            var scene = this;\r\n            if (toggle) {\r\n                scene.j2Ds.events.addEvent('engine:before', function () {\r\n                    scene.clear();\r\n                }, 'autoClear');\r\n            } else {\r\n                scene.j2Ds.events.destroyEvent('engine:before', 'autoClear');\r\n            }\r\n        };\r\n\r\n        Scene.prototype.setGameState = function (name) {\r\n            if (this.j2Ds.gameStates.states[name].start) {\r\n                this.j2Ds.gameStates.states[name].start();\r\n            }\r\n            if (this.j2Ds.gameStates.states[name].state) {\r\n                this.j2Ds.setActiveEngine(this.j2Ds.gameStates.states[name].state);\r\n            }\r\n            this.gameStateName = name;\r\n            this.j2Ds.events.onEvent('scene:changedGameState');\r\n        };\r\n\r\n        Scene.prototype.getGameState = function () {\r\n            return this.gameStateName;\r\n        };\r\n\r\n        Scene.prototype.start = function (name, frameLimit) {\r\n            this.j2Ds.events.onEvent('scene:beforeStart');\r\n            if (this.j2Ds.gameStates.states[name].start) {\r\n                this.j2Ds.gameStates.states[name].start();\r\n            }\r\n            if (this.j2Ds.gameStates.states[name]) {\r\n                this.j2Ds.start(this.j2Ds.gameStates.states[name].state, frameLimit);\r\n            }\r\n            this.j2Ds.events.onEvent('scene:afterStart');\r\n        };\r\n\r\n        Scene.prototype.fullScreen = function (_true) {\r\n            if (!this.canFullScreen) return;\r\n            var layer;\r\n            var tmpCanvas = document.createElement('canvas'); // Нужны для копирования содержимого\r\n            var tmpContext = tmpCanvas.getContext('2d');      // При изменении размера\r\n            if (_true) {\r\n                this.origWidth = this.width;\r\n                this.origHeight = this.height;\r\n                this.width = this.j2Ds.getDeviceManager().width;\r\n                this.height = this.j2Ds.getDeviceManager().height;\r\n                for (var i in this.j2Ds.layers.layersList) {\r\n                    layer = this.j2Ds.layers.layersList[i];\r\n                    tmpCanvas.width = layer.width;\r\n                    tmpCanvas.height = layer.height;\r\n                    tmpContext.drawImage(layer.canvas, 0, 0);\r\n                    layer.canvas.width = this.width;\r\n                    layer.canvas.height = this.height;\r\n                    layer.width = this.width;\r\n                    layer.height = this.height;\r\n                    this.offsetWidth = this.width;\r\n                    this.offsetHeight = this.height;\r\n\r\n                    layer.context.drawImage(tmpCanvas, 0, 0, layer.width, layer.height);\r\n                }\r\n            } else {\r\n                this.width = this.origWidth;\r\n                this.height = this.origHeight;\r\n                for (var i in this.j2Ds.layers.layersList) {\r\n                    layer = this.j2Ds.layers.layersList[i];\r\n                    layer.width = this.origWidth;\r\n                    layer.height = this.origHeight;\r\n                    layer.canvas.width = this.origWidth;\r\n                    layer.canvas.height = this.origHeight;\r\n                    this.offsetWidth = this.origWidth;\r\n                    this.offsetHeight = this.origHeight;\r\n\r\n                }\r\n            }\r\n        };\r\n\r\n        Scene.prototype.fullScale = function (_true) {\r\n            if (!this.canFullScreen) return;\r\n            var layer;\r\n            if (_true) {\r\n                for (var i in this.j2Ds.layers.layersList) {\r\n                    layer = this.j2Ds.layers.layersList[i].canvas;\r\n                    layer.style.width = this.j2Ds.getDeviceManager().width + 'px';\r\n                    layer.style.height = this.j2Ds.getDeviceManager().height + 'px';\r\n                    this.offsetWidth = this.j2Ds.getDeviceManager().width;\r\n                    this.offsetHeight = this.j2Ds.getDeviceManager().height;\r\n                }\r\n            } else {\r\n                for (var i in this.j2Ds.layers.layersList) {\r\n                    layer = this.j2Ds.layers.layersList[i].canvas;\r\n                    layer.style.width = this.width + 'px';\r\n                    layer.style.height = this.height + 'px';\r\n                    this.offsetWidth = this.width;\r\n                    this.offsetHeight = this.height;\r\n                }\r\n            }\r\n        };\r\n\r\n        Scene.prototype.clear = function () {\r\n            this.getLayer().clear();\r\n        };\r\n\r\n        Scene.prototype.getLayer = function () {\r\n            return this.j2Ds.layers.layer(this.layerName);\r\n        };\r\n\r\n        Scene.prototype.drawAllNodes = function () {\r\n            for (var i = 0, len = this.nodes.length; i < len; i += 1) {\r\n                if (this.nodes[i].draw) {\r\n                    this.nodes[i].draw();\r\n                }\r\n            }\r\n        };\r\n\r\n        Scene.prototype.init = function (width, height, canDeactivate) {\r\n            var scene = this;\r\n\r\n            scene.j2Ds.events.onEvent('scene:beforeInit');\r\n\r\n            scene.width = width;\r\n            scene.height = height;\r\n\r\n            scene.origWidth = width;\r\n            scene.origHeight = height;\r\n\r\n            scene.offsetWidth = width;\r\n            scene.offsetHeight = height;\r\n\r\n            scene.offsetLeft = 0;\r\n            scene.offsetTop = 0;\r\n\r\n\r\n            scene.j2Ds.canDeactivate = canDeactivate != false;\r\n\r\n            scene.j2Ds.layers.add('sceneNode', 0);\r\n\r\n            scene.context = scene.j2Ds.layers.layer(scene.layerName).context;\r\n            scene.canvas = scene.j2Ds.layers.layer(scene.layerName).canvas;\r\n            scene.visible = true;\r\n\r\n            scene.cancelClear = false;\r\n\r\n            /* Вид \"камеры\" */\r\n            scene.view = scene.j2Ds.viewManager.add('sceneView');\r\n\r\n            scene.j2Ds.events.onEvent('scene:afterInit');\r\n\r\n            scene.j2Ds.window.onload = function () {\r\n\r\n                scene.j2Ds.window.focus();\r\n\r\n                scene.j2Ds.window.onblur = function () {\r\n                    if (scene.j2Ds.stopAll == 0) {\r\n                        scene.j2Ds.stopEngine();\r\n                        scene.j2Ds.events.onEvent('scene:deactivate');\r\n                    }\r\n                };\r\n\r\n                scene.j2Ds.window.onfocus = function () {\r\n                    if (scene.j2Ds.stopAll == 1) {\r\n\r\n                        scene.j2Ds.runEngine(scene.j2Ds);\r\n                        scene.j2Ds.events.onEvent('scene:activate');\r\n                    }\r\n                };\r\n\r\n                for (var i in scene.j2Ds.layers.layersList) {\r\n                    scene.j2Ds.dom.attach(scene.j2Ds.layers.layer(i).canvas);\r\n                }\r\n\r\n                scene.j2Ds.ready = true;\r\n\r\n                scene.j2Ds.events.onEvent('dom:loaded');\r\n            };\r\n        };\r\n\r\n        Scene.prototype.initCanvas = function (id, canDeactivate) {\r\n            var scene = this;\r\n\r\n            scene.canFullScreen = false;\r\n\r\n            scene.layerName = id;\r\n\r\n            scene.j2Ds.events.onEvent('scene:beforeInit');\r\n\r\n            scene.width = parseInt(scene.j2Ds.dom.id(id).width);\r\n            scene.height = parseInt(scene.j2Ds.dom.id(id).height);\r\n\r\n            scene.origWidth = scene.width;\r\n            scene.origHeight = scene.height;\r\n\r\n            scene.offsetWidth = parseInt(scene.j2Ds.dom.id(id).offsetWidth);\r\n            scene.offsetHeight = parseInt(scene.j2Ds.dom.id(id).offsetHeight);\r\n\r\n            scene.offsetLeft = parseInt(scene.j2Ds.dom.id(id).offsetLeft);\r\n            scene.offsetTop = parseInt(scene.j2Ds.dom.id(id).offsetTop);\r\n\r\n            scene.stylePosition = scene.j2Ds.dom.id(id).style.position == 'fixed' ? 'fixed' : 'absolute';\r\n\r\n            scene.j2Ds.canDeactivate = canDeactivate != false;\r\n\r\n            scene.j2Ds.layers.add(id, 0, 1);\r\n\r\n            scene.context = scene.j2Ds.layers.layer(id).context;\r\n            scene.canvas = scene.j2Ds.layers.layer(id).canvas;\r\n            scene.visible = true;\r\n\r\n            scene.cancelClear = false;\r\n\r\n            /* Вид \"камеры\" */\r\n            scene.view = scene.j2Ds.viewManager.add('sceneView');\r\n\r\n            scene.j2Ds.events.onEvent('scene:afterInit');\r\n\r\n            scene.j2Ds.window.onload = function () {\r\n\r\n                scene.j2Ds.window.focus();\r\n\r\n                scene.j2Ds.window.onblur = function () {\r\n                    if (scene.j2Ds.stopAll == 0) {\r\n                        scene.j2Ds.stopEngine();\r\n                        scene.j2Ds.events.onEvent('scene:deactivate');\r\n                    }\r\n                };\r\n\r\n                scene.j2Ds.window.onfocus = function () {\r\n                    if (scene.j2Ds.stopAll == 1) {\r\n                        scene.j2Ds.runEngine(scene.j2Ds);\r\n                        scene.j2Ds.events.onEvent('scene:activate');\r\n                    }\r\n                };\r\n\r\n                for (var i in scene.j2Ds.layers.layersList) {\r\n                    scene.j2Ds.dom.attach(scene.j2Ds.layers.layer(i).canvas);\r\n                }\r\n\r\n                scene.j2Ds.ready = true;\r\n\r\n                scene.j2Ds.events.onEvent('dom:loaded');\r\n            };\r\n        };\r\n\r\n        /* Nodes */\r\n        Scene.prototype.addBaseNode = function (pos, size) {\r\n            return new BaseNode(this.j2Ds, pos, size);\r\n        };\r\n\r\n        Scene.prototype.addCircleNode = function (pos, radius, color) {\r\n            return new CircleNode(this.j2Ds, pos, radius, color);\r\n        };\r\n\r\n        Scene.prototype.addLineNode = function (pos, points, scale, color, width, fill, cFill) {\r\n            return new LineNode(this.j2Ds, pos, points, scale, color, width, fill, cFill);\r\n        };\r\n\r\n        Scene.prototype.addRectNode = function (pos, size, color) {\r\n            return new RectNode(this.j2Ds, pos, size, color);\r\n        };\r\n\r\n        Scene.prototype.addSpriteNode = function (pos, size, animation) {\r\n            return new SpriteNode(this.j2Ds, pos, size, animation);\r\n        };\r\n\r\n        Scene.prototype.addTextNode = function (pos, text, sizePx, color, family, width, colorL) {\r\n            return new TextNode(this.j2Ds, pos, text, sizePx, color, family, width, colorL);\r\n        };\r\n\r\n        if (typeof module === 'object' && typeof module.exports === 'object') module.exports.Scene = Scene;\r\n        if (global.j2Ds !== undefined) global.modules.core.Scene = Scene;\r\n        return Scene;\r\n    }));\r\n","/**\r\n * j2Ds (HTML5 2D Game Engine)\r\n *\r\n * @authors Skaner, DeVinterX\r\n * @license zlib\r\n * @version 0.6.4\r\n */\r\n\r\n/**\r\n * @module \"j2Ds\"\r\n */\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('j2Ds', [\r\n            'core/Dom',\r\n            'core/Gui',\r\n            'core/Events',\r\n            'core/Layers',\r\n            'core/Scene',\r\n\r\n            'io/AudioHandler',\r\n            'io/InputHandler',\r\n\r\n            'managers/DeviceManager',\r\n            'managers/ErrorManager',\r\n            'managers/FpsManager',\r\n            'managers/ResourceManager',\r\n            'managers/StorageManager',\r\n            'managers/TimeManager',\r\n            'managers/TriggerManager',\r\n            'managers/ViewManager',\r\n\r\n            'utils/MathUtil',\r\n            'utils/TextureUtil'\r\n        ], factory);\r\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\r\n        module.exports = factory(\r\n            require('core/Dom'),\r\n            require('core/Gui'),\r\n            require('core/Events'),\r\n            require('core/Layers'),\r\n            require('core/Scene'),\r\n\r\n            require('io/AudioHandler'),\r\n            require('io/InputHandler'),\r\n\r\n            require('managers/DeviceManager'),\r\n            require('managers/ErrorManager'),\r\n            require('managers/FpsManager'),\r\n            require('managers/ResourceManager'),\r\n            require('managers/StorageManager'),\r\n            require('managers/TimeManager'),\r\n            require('managers/TriggerManager'),\r\n            require('managers/ViewManager'),\r\n\r\n            require('utils/MathUtil'),\r\n            require('utils/TextureUtil')\r\n        );\r\n    } else {\r\n        factory(\r\n            root.modules.core.Dom,\r\n            root.modules.core.Gui,\r\n            root.modules.core.Events,\r\n            root.modules.core.Layers,\r\n            root.modules.core.Scene,\r\n\r\n            root.modules.io.AudioHandler,\r\n            root.modules.io.InputHandler,\r\n\r\n            root.modules.managers.DeviceManager,\r\n            root.modules.managers.ErrorManager,\r\n            root.modules.managers.FpsManager,\r\n            root.modules.managers.ResourceManager,\r\n            root.modules.managers.StorageManager,\r\n            root.modules.managers.TimeManager,\r\n            root.modules.managers.TriggerManager,\r\n            root.modules.managers.ViewManager,\r\n\r\n            root.modules.utils.MathUtil,\r\n            root.modules.utils.TextureUtil\r\n        );\r\n    }\r\n}(typeof window !== 'undefined' ? window : global,\r\n    function (DOM,\r\n              GUI,\r\n              Events,\r\n              Layers,\r\n              Scene,\r\n              AudioHandler,\r\n              InputHandler,\r\n              DeviceManager,\r\n              ErrorManager,\r\n              FPSManager,\r\n              ResourceManager,\r\n              StorageManager,\r\n              TimeManager,\r\n              TriggerManager,\r\n              ViewManager,\r\n              MathUtil) {\r\n        \"use strict\";\r\n\r\n        var frameLimit = 60;\r\n\r\n        /**\r\n         * @class j2DsEngine\r\n         * @exports module:\"j2Ds\"\r\n         * @alias module:\"j2Ds\"\r\n         *\r\n         * @constructor\r\n         * @property {number} now\r\n         * @property {number} dt\r\n         * @property {number} stopAll\r\n         * @property {number} frameLimit\r\n         * @property {number} sceneStartTime\r\n         * @property {number} sceneSkipTime\r\n         * @property {function} engine\r\n         * @property {boolean} ready\r\n         * @property {Window} window\r\n         * @property {boolean} canDeactivate\r\n         */\r\n        var j2DsEngine = function () {\r\n            this.now = Date.now();\r\n            this.dt = 0;\r\n            this.stopAll = 0;\r\n            this.frameLimit = 60;\r\n            this.sceneStartTime = 0;\r\n            this.sceneSkipTime = 0;\r\n            this.engine = function () {\r\n                this.errorManager.show('Не инициализировано ни одно игровое состояние', 'red');\r\n                this.stopEngine();\r\n            };\r\n            this.ready = false;\r\n            this.window = window;\r\n            this.canDeactivate = true;\r\n\r\n            this.events = new Events(this);\r\n            this.dom = new DOM(this);\r\n            this.gui = new GUI(this);\r\n            this.resources = new ResourceManager(this);\r\n            this.trigger = new TriggerManager(this);\r\n            this.timeManager = new TimeManager(this);\r\n            this.deviceManager = DeviceManager();\r\n            this.errorManager = new ErrorManager(this);\r\n            this.fpsManager = new FPSManager(this);\r\n            this.input = new InputHandler(this);\r\n            this.layers = new Layers(this);\r\n            this.viewManager = new ViewManager(this);\r\n            this.scene = new Scene(this);\r\n\r\n            /**\r\n             * @method\r\n             * @param {string} id\r\n             * @returns {StorageManager}\r\n             */\r\n            this.createLocal = function (id) {\r\n                return new StorageManager(this, id);\r\n            }\r\n        };\r\n\r\n        /* Getters & Setters */\r\n        /**\r\n         * @returns {{name: string, version: string, git: string, site: string, description: string, author: string}}\r\n         */\r\n        j2DsEngine.prototype.getInfo = function () {\r\n            return {\r\n                'name': 'j2Ds',\r\n                'version': '0.6.4',\r\n                'git': 'https://github.com/SkanerSoft/j2Ds',\r\n                'site': 'http://j2ds.ru',\r\n                'description': 'HTML5 2D Game Engine',\r\n                'author': 'Skaner'\r\n            };\r\n        };\r\n\r\n        /**\r\n         * @returns {FpsManager}\r\n         */\r\n        j2DsEngine.prototype.getFPSManager = function () {\r\n            this.fpsManager.init();\r\n            return this.fpsManager;\r\n        };\r\n\r\n        /**\r\n         * @returns {SceneManager}\r\n         */\r\n        j2DsEngine.prototype.getSceneManager = function () {\r\n            return this.scene;\r\n        };\r\n\r\n        /**\r\n         * @returns {Layers}\r\n         */\r\n        j2DsEngine.prototype.getLayerManager = function () {\r\n            return this.layers;\r\n        };\r\n\r\n        /**\r\n         * @returns {TextureUtil}\r\n         */\r\n        j2DsEngine.prototype.getTextureManager = function () {\r\n            return this.scene.texture;\r\n        };\r\n\r\n        /**\r\n         * @returns {AudioHandler}\r\n         */\r\n        j2DsEngine.prototype.getAudioManager = function () {\r\n            this.audio.init();\r\n            return this.audio;\r\n        };\r\n\r\n        /** @deprecated */\r\n        j2DsEngine.prototype.getPaintManager = function () {\r\n            return this.paint;\r\n        };\r\n\r\n        /**\r\n         * @returns {InputHandler}\r\n         */\r\n        j2DsEngine.prototype.getIO = function () {\r\n            this.input.init();\r\n            return this.input;\r\n        };\r\n\r\n        /**\r\n         * @returns {Dom}\r\n         */\r\n        j2DsEngine.prototype.getDOMManager = function () {\r\n            return this.dom;\r\n        };\r\n\r\n        /**\r\n         * @returns {TriggerManager}\r\n         */\r\n        j2DsEngine.prototype.getTriggerManager = function () {\r\n            this.trigger.init();\r\n            return this.trigger;\r\n        };\r\n\r\n        /**\r\n         * @returns {MathUtil}\r\n         */\r\n        j2DsEngine.prototype.getMathManager = function () {\r\n            return MathUtil;\r\n        };\r\n\r\n        /**\r\n         * @returns {{states: {}, add: j2DsEngine.gameStates.add}}\r\n         */\r\n        j2DsEngine.prototype.getGameStateManager = function () {\r\n            return this.gameStates;\r\n        };\r\n\r\n        /**\r\n         * @returns {ViewManager}\r\n         */\r\n        j2DsEngine.prototype.getViewManager = function () {\r\n            return this.viewManager;\r\n        };\r\n\r\n        /**\r\n         * @returns {DeviceManager}\r\n         */\r\n        j2DsEngine.prototype.getDeviceManager = function () {\r\n            return this.deviceManager;\r\n        };\r\n\r\n        /**\r\n         * @returns {ErrorManager}\r\n         */\r\n        j2DsEngine.prototype.getErrorManager = function () {\r\n            this.errorManager.init();\r\n            return this.errorManager;\r\n        };\r\n\r\n        /**\r\n         * @returns {TimeManager}\r\n         */\r\n        j2DsEngine.prototype.getTimeManager = function () {\r\n            return this.timeManager;\r\n        };\r\n\r\n        /**\r\n         * @returns {ResourceManager}\r\n         */\r\n        j2DsEngine.prototype.getResourceManager = function () {\r\n            return this.resources;\r\n        };\r\n\r\n        /**\r\n         * @param {Window} global\r\n         */\r\n        j2DsEngine.prototype.setWindow = function (global) {\r\n            this.window = global ? global : window;\r\n        };\r\n\r\n        /**\r\n         * @param {number} fps\r\n         */\r\n        j2DsEngine.prototype.setFrameLimit = function (fps) {\r\n            this.frameLimit = (fps > 0 && fps <= 60) ? fps : 60;\r\n            frameLimit = this.frameLimit;\r\n        };\r\n\r\n        /**\r\n         * @param {function} engine\r\n         */\r\n        j2DsEngine.prototype.setActiveEngine = function (engine) {\r\n            this.engine = typeof engine == 'function'\r\n                ? engine\r\n                : this.errorManager.show('Error in \"GameStateManager\"');\r\n        };\r\n\r\n        /**\r\n         * @type {{states: {}, add: j2DsEngine.gameStates.add}}\r\n         */\r\n        j2DsEngine.prototype.gameStates = {\r\n            states: {},\r\n\r\n            add: function (name, _state, start, end) {\r\n                var state = {};\r\n                state.state = _state;\r\n                state.start = start || false;\r\n                state.end = end || false;\r\n\r\n                this.states[name] = state;\r\n            }\r\n        };\r\n\r\n        /**\r\n         * @param {function} engine\r\n         * @param {number} frameLimit\r\n         */\r\n        j2DsEngine.prototype.start = function (engine, frameLimit) {\r\n            this.setActiveEngine(engine);\r\n            this.frameLimit = frameLimit || 60;\r\n            this.sceneSkipTime = 1000.0 / this.frameLimit;\r\n            this.lastTime = Date.now();\r\n            this.dt = 0;\r\n            this.sceneStartTime = this.lastTime;\r\n            this.gameEngine(this);\r\n        };\r\n\r\n        /**\r\n         * @param {j2DsEngine} j2Ds\r\n         */\r\n        j2DsEngine.prototype.gameEngine = function (j2Ds) {\r\n            j2Ds.now = Date.now();\r\n            setTimeout(function () {\r\n                if (!j2Ds.stopAll) {\r\n                    j2Ds.dt = (j2Ds.now - j2Ds.lastTime) / 100.0;\r\n                    j2Ds.sceneStartTime = j2Ds.now;\r\n                    if (j2Ds.dt > j2Ds.sceneSkipTime / 2) j2Ds.dt = 0;\r\n\r\n                    j2Ds.events.onEvent('engine:before');\r\n\r\n                    try {\r\n                        j2Ds.engine();\r\n                    } catch (err) {\r\n                        j2Ds.errorManager.showError(err);\r\n                    }\r\n\r\n                    j2Ds.events.onEvent('engine:after');\r\n\r\n                    j2Ds.lastTime = j2Ds.now;\r\n\r\n                    requestAnimationFrame(function () {\r\n                        j2Ds.gameEngine(j2Ds);\r\n                    });\r\n                }\r\n            }, (j2Ds.frameLimit < 60 ? j2Ds.sceneSkipTime : 0));\r\n        };\r\n\r\n        var requestAnimationFrame = (function () {\r\n            return window.requestAnimationFrame ||\r\n                window.webkitRequestAnimationFrame ||\r\n                window.mozRequestAnimationFrame ||\r\n                window.oRequestAnimationFrame ||\r\n                window.msRequestAnimationFrame ||\r\n                function (callback) {\r\n                    window.setTimeout(callback, 1000 / frameLimit);\r\n                };\r\n        })();\r\n\r\n        /**\r\n         *\r\n         */\r\n        j2DsEngine.prototype.stopEngine = function () {\r\n            if (!this.canDeactivate) return;\r\n            this.stopAll = true;\r\n        };\r\n\r\n        /**\r\n         * @param {j2DsEngine} j2Ds\r\n         */\r\n        j2DsEngine.prototype.runEngine = function (j2Ds) {\r\n            j2Ds = j2Ds || this;\r\n            if (!j2Ds.canDeactivate) return;\r\n            if (!j2Ds.stopAll) return;\r\n            j2Ds.stopAll = false;\r\n            requestAnimationFrame(function () {\r\n                j2Ds.gameEngine(j2Ds);\r\n            });\r\n        };\r\n\r\n        if (typeof module === 'object' && typeof module.exports === 'object') module.exports.j2Ds = j2DsEngine;\r\n        if (global.j2Ds !== undefined) global.modules.core.j2Ds = j2DsEngine;\r\n        if (global.j2Ds !== undefined) global.j2Ds = new j2DsEngine();\r\n        return j2DsEngine;\r\n    }\r\n));\r\n"]}